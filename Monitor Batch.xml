<?xml version="1.0" encoding="UTF-8" ?>
<displays>
<folder>
	<name><![CDATA[02. Monitor Batch]]></name>
	<tooltip><![CDATA[Monitor Batch]]></tooltip>
	<description><![CDATA[ ]]></description>
		<display id="85069e67-014b-1000-8002-c0a80143b4a7" type="" style="plsql-dbms_output" enable="true">
		<name><![CDATA[09. OLTP Top10]]></name>
		<description><![CDATA[]]></description>
		<tooltip><![CDATA[]]></tooltip>
		<drillclass><![CDATA[]]></drillclass>
		<CustomValues>
		</CustomValues>
		<query>
			<sql><![CDATA[declare
  days       varchar2(60) := 'Monday';
  begin_snap date;
  end_snap   date;
  start_date date;
  rowcount   number :=0;
  myFile     utl_file.file_type;
  dirName    varchar2(40) := 'DATA_PUMP_DIR';
  fileName   VARCHAR2(50);
  db_name    varchar2(30);
  today      varchar2(30);
  cursor instances is
    select distinct
      instance_number
    from
      DBA_HIST_SQLSTAT
    order by instance_number;
  cursor top10( instance_number_v number
              , begin_snap timestamp
              , end_snap timestamp) is
    select * from (
      SELECT
        STAT.INSTANCE_NUMBER INST
      , rpad(STAT.SQL_ID, 30) SQL_ID
      , PLAN_HASH_VALUE
      , STAT.INSTANCE_NUMBER
      , STAT.OPTIMIZER_COST
      , rpad(STAT.DISK_READS_DELTA, 30) DISK_READS_DELTA
--    , floor(ELAPSED_TIME_DELTA/1000000) ELAPSED_TIME
      , CASE 
          WHEN ELAPSED_TIME_DELTA is null then ' '
          WHEN ELAPSED_TIME_DELTA/1000000 > 3600*24 then
            TO_CHAR(TRUNC(ELAPSED_TIME_DELTA/1000000/3600/24),'FM990') || 'd ' ||
            TO_CHAR(TRUNC(MOD(ELAPSED_TIME_DELTA/1000000,3600*24)/3600),'FM90')|| 'h:' ||
            TO_CHAR(TRUNC(MOD(ELAPSED_TIME_DELTA/1000000,3600)/60),'FM00') || 'm:' ||
            TO_CHAR(MOD(ELAPSED_TIME_DELTA/1000000,60),'FM00')|| 's'
          ELSE
            TO_CHAR(TRUNC(ELAPSED_TIME_DELTA/1000000/3600),'FM90') || 'h:' ||
            TO_CHAR(TRUNC(MOD(ELAPSED_TIME_DELTA/1000000,3600)/60),'FM00') || 'm:' ||
            TO_CHAR(MOD(ELAPSED_TIME_DELTA/1000000,60),'FM00')|| 's'
        END ELAPSED_TIME
      , rpad(EXECUTIONS_DELTA,30) EXECUTIONS
      , ROWS_PROCESSED_DELTA
      , STAT.SNAP_ID
      , to_char(SS.BEGIN_INTERVAL_TIME, 'DD-MON-YYYY HH24:MI') BEGIN_INTERVAL_TIME
      , to_char(SS.END_INTERVAL_TIME, 'DD-MON-YYYY HH24:MI') END_INTERVAL_TIME
      , case
          when instr(STAT.module,'@',1,1) > 0 then rpad(substr(STAT.module, 1, instr(STAT.module,'@',1,1)-1),30)
          when instr(STAT.module,'.',-1,1) > 0 then rpad(substr(STAT.module, 1, instr(STAT.module,'.',-1,1)-1),30)
        else
          rpad(STAT.module,30)
        end module
      , nvl(ACTION, '(null)') ACTION
      , rpad(PARSING_SCHEMA_NAME,30) PARSING_SCHEMA_NAME
      --, substr(SQL_TEXT, 1, 2048) SQL_TEXT
      , REPLACE(SQL_TEXT,chr(0)) SQL_TEXT
      FROM
        DBA_HIST_SQLSTAT STAT
      , DBA_HIST_SQLTEXT TXT
      , DBA_HIST_SNAPSHOT SS
      WHERE
        STAT.SQL_ID = TXT.SQL_ID AND
        STAT.DBID = TXT.DBID AND
        SS.DBID = STAT.DBID AND
        SS.INSTANCE_NUMBER = STAT.INSTANCE_NUMBER AND
        STAT.SNAP_ID = SS.SNAP_ID AND
        PARSING_SCHEMA_NAME not in ('SYS', 'SYSTEM', 'DBSNMP', 'SYSMAN') AND
        STAT.INSTANCE_NUMBER = instance_number_v AND
        to_date(to_char(SS.BEGIN_INTERVAL_TIME, 'MM-DD-YYYY HH24:MI:SS'), 'MM-DD-YYYY HH24:MI:SS') between begin_snap and end_snap AND
        SQL_TEXT not like '%dbms_stats%' AND
        MODULE not in ('DBMS_SCHEDULER', 'SQL Developer', 'Data Pump Worker','SQL*Plus') AND
        MODULE not like 'TOAD%' AND
        floor(ELAPSED_TIME_DELTA/1000000) >= 20 AND
        EXECUTIONS_DELTA <= 2
      ORDER BY
        ELAPSED_TIME_DELTA desc)
      where rownum < 11;
begin
  dbms_output.put_line('<PRE>');
  DBMS_OUTPUT.ENABLE (buffer_size => NULL);
  select name into db_name from v$database;
  select to_char(sysdate, 'YYYYMMDD') into today from dual;
  select next_day(to_date(to_char(sysdate-13, 'DD-MM-YYYY'), 'DD-MM-YYYY'), 1) into start_date from dual;
  --fileName := 'weekdays_top10_'||db_name||'_'||today||'.log';
  --myFile := utl_file.fopen(dirName, fileName, 'w', 32767);
  for days in 2..6 loop
    select next_day(to_date(to_char(start_date, 'DD-MM-YYYY'), 'DD-MM-YYYY')+8/24, days), next_day(to_date(to_char(start_date, 'DD-MM-YYYY'), 'DD-MM-YYYY')+18/24, days) into begin_snap, end_snap from dual;
    for instances_rec in instances loop
    null;
      rowcount := 0;
      --dbms_output.put_line('Date: '||to_char(begin_snap, 'DD-MON-YYYY')||'  INST:   '||instances_rec.INSTANCE_NUMBER);
      --utl_file.new_line(myFile);
      for top10_rec in top10(instances_rec.instance_number, begin_snap, end_snap) loop
        rowcount := rowcount+1;
        dbms_output.put_line(rpad(rowcount||'. ',3)||'         INST: '||instances_rec.INSTANCE_NUMBER||'                         Date: '||to_char(begin_snap, 'DD-MON-YYYY'));
        dbms_output.put_line('BEGIN:      '||rpad(top10_rec.BEGIN_INTERVAL_TIME,30)||'  END:            '||rpad(top10_rec.END_INTERVAL_TIME,30)||' SNAP_ID: '||top10_rec.SNAP_ID);
        dbms_output.put_line('SQL_ID:     '||top10_rec.SQL_ID||'  PLAN_HASH:      '||top10_rec.PLAN_HASH_VALUE);
        dbms_output.put_line('EXECUTIONS: '||top10_rec.EXECUTIONS||'  ELAPSED_TIME:   '||top10_rec.ELAPSED_TIME);
        dbms_output.put_line('DISK_READS: '||top10_rec.DISK_READS_DELTA||'  ROWS_PROCESSED: '||top10_rec.ROWS_PROCESSED_DELTA);
        dbms_output.put_line('MODULE:     '||top10_rec.MODULE||'  ACTION:         '||top10_rec.ACTION);
        dbms_output.put_line('Schema:     '||top10_rec.PARSING_SCHEMA_NAME||'  SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY_AWR('||''''||trim(top10_rec.SQL_ID)||''''||'));');
        dbms_output.put_line('SQL_TEXT:');
        dbms_output.put_line(top10_rec.SQL_TEXT);
        dbms_output.new_line;
      end loop; -- end top10_rec loop
      dbms_output.put_line(rpad('=',132,'='));
    end loop; -- end instances_rec loop
    dbms_output.put_line(rpad('=',132,'='));
  end loop; -- end days loop
  dbms_output.put_line('</PRE>');
end;]]></sql>
		</query>
			<pdf version="VERSION_1_7" compression="CONTENT">
				<docproperty title="null" author="null" subject="null" keywords="null" />
				<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
				<column>
					<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
					<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
					<blob blob="NONE" zip="false" />
				</column>
				<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
				<header enable="false" generatedate="false">
					<data>
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
				
				
				null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								</data>
				</header>
				<footer enable="false" generatedate="false">
					<data value="null" />
				</footer>
				<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
			</pdf>
	</display>
	<display id="49678dd6-014d-1000-803e-0a6e242573fd" type="" style="Table" enable="true">
		<name><![CDATA[02. Index Usage History]]></name>
		<description><![CDATA[]]></description>
		<tooltip><![CDATA[]]></tooltip>
		<drillclass><![CDATA[]]></drillclass>
		<CustomValues>
			<TYPE><![CDATA[horizontal]]></TYPE>
		</CustomValues>
		<query>
			<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select distinct
  b.INSTANCE_NUMBER inst_id
, b.SNAP_ID
, a.sql_id
, b.PLAN_HASH_VALUE
, case 
    when instr(b.module,'@',1,1) > 0 then substr(b.module, 1, instr(b.module,'@',1,1)-1) 
    when instr(b.module,'.',-1,1) > 0 then substr(b.module, 1, instr(b.module,'.',-1,1)-1) 
  else
    b.module
  end module
, nvl(b.action, 'N/A') action
, a.object_name INDEX_NAME
, a.options
, a.operation
, a.cost
, CASE
    WHEN cardinality >= 1000000000 THEN TO_CHAR(TRUNC(cardinality/1000000000),'FM000') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(TRUNC(cardinality/1000000),'FM000') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(TRUNC(cardinality/1000),'FM000') || ' K'
    ELSE TO_CHAR(cardinality,'FM000') || '  '
  END "ROWS"
, CASE 
    WHEN (b.ELAPSED_TIME_DELTA/1000000) is null then ' '
    WHEN (b.ELAPSED_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((b.ELAPSED_TIME_DELTA/1000000)/3600/24),'FM9900') || 'd ' ||
      TO_CHAR(TRUNC(MOD((b.ELAPSED_TIME_DELTA/1000000),3600*24)/3600),'FM9900')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((b.ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((b.ELAPSED_TIME_DELTA/1000000),60),'FM00')||'s'
    ELSE
      TO_CHAR(TRUNC((b.ELAPSED_TIME_DELTA/1000000)/3600),'FM9900') || 'h:' ||
      TO_CHAR(TRUNC(MOD((b.ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((b.ELAPSED_TIME_DELTA/1000000),60),'FM00')||'s'
  END ELAPSED_TIME
, b.ROWS_PROCESSED_DELTA ROWS_PROCESSED
--, a.TIMESTAMP
, b.SQL_PROFILE
, TO_CHAR(c.END_INTERVAL_TIME, 'DY DD-MON-YYYY HH:MI:SS AM') END_INTERVAL_TIME
, count(*) "#SQL"
, sum(b.executions_delta) "#EXECUTIONS"
, 'select * from table(dbms_xplan.display_awr('||''''||a.sql_id||''''||'));' xplan
from
  DBA_HIST_SQL_PLAN a
, DBA_HIST_SQLSTAT b
, DBA_HIST_SNAPSHOT c
where
  a.sql_id             = b.sql_id                    AND
  b.snap_id            = c.snap_id                   AND
  a.PLAN_HASH_VALUE    = b.PLAN_HASH_VALUE           AND
--c.END_INTERVAL_TIME >= trunc(sysdate)- :DAYS       AND
  operation              like '%INDEX%'              AND
  ( b.module             not like '%EMSTATSUPD%' or b.action <> 'EMSTATSUPD') AND
  object_owner   not in (
                        'APEX_030200'
                      , 'APEX_PUBLIC_USER'
                      , 'APPQOSSYS'
                      , 'CTXSYS'
                      , 'DBSNMP'
                      , 'DIP'
                      , 'EXFSYS'
                      , 'FLOWS_FILES'
                      , 'HR'
                      , 'MDSYS'
                      , 'OE'
                      , 'OLAPSYS'
                      , 'ORACLE_OCM'
                      , 'ORDDATA'
                      , 'ORDPLUGINS'
                      , 'ORDSYS'
                      , 'OUTLN'
                      , 'OWBSYS_AUDIT'
                      , 'OWBSYS'
                      , 'SCOTT'
                      , 'SH'
                      , 'SI_INFORMTN_SCHEMA'
                      , 'SYS'
                      , 'SYSMAN'
                      , 'SYSTEM'
                      , 'WMSYS'
                      , 'XDB'
                      ) AND
  PARSING_SCHEMA_NAME not in (
                             'APEX_030200'
                           , 'APEX_PUBLIC_USER'
                           , 'APPQOSSYS'
                           , 'CTXSYS'
                           , 'DBSNMP'
                           , 'DIP'
                           , 'EXFSYS'
                           , 'FLOWS_FILES'
                           , 'HR'
                           , 'MDSYS'
                           , 'OE'
                           , 'OLAPSYS'
                           , 'ORACLE_OCM'
                           , 'ORDDATA'
                           , 'ORDPLUGINS'
                           , 'ORDSYS'
                           , 'OUTLN'
                           , 'OWBSYS_AUDIT'
                           , 'OWBSYS'
                           , 'SCOTT'
                           , 'SH'
                           , 'SI_INFORMTN_SCHEMA'
                           , 'SYS'
                           , 'SYSMAN'
                           , 'SYSTEM'
                           , 'WMSYS'
                           , 'XDB'
                           ) and
  (object_name like trim(upper(:INDEX_NAME)) or instr(object_name, trim(upper(:INDEX_NAME))) > 0)
group by
  b.INSTANCE_NUMBER
, b.SNAP_ID
, a.sql_id
, b.PLAN_HASH_VALUE
, b.MODULE
, b.ACTION
, a.object_name
, a.options
, a.operation
, a.cost
, a.cardinality
, b.SQL_PROFILE
, ELAPSED_TIME_DELTA
, b.ROWS_PROCESSED_DELTA 
, c.END_INTERVAL_TIME
order by
  TO_DATE(TO_CHAR(c.END_INTERVAL_TIME, 'DY DD-MON-YYYY HH:MI:SS AM'), 'DY DD-MON-YYYY HH:MI:SS AM') 
, a.sql_id]]></sql>
			<binds>
				<bind id="INDEX_NAME">
					<prompt><![CDATA[INDEX_NAME]]></prompt>
					<tooltip><![CDATA[INDEX_NAME]]></tooltip>
					<value><![CDATA[JH_%]]></value>
					<bracket><![CDATA[null]]></bracket>
				</bind>
			</binds>
		</query>
			<pdf version="VERSION_1_7" compression="CONTENT">
				<docproperty title="null" author="null" subject="null" keywords="null" />
				<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
				<column>
					<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
					<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
					<blob blob="NONE" zip="false" />
				</column>
				<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
				<header enable="false" generatedate="false">
					<data>
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
				
					
					
					
					
					
					
					
					
					
				
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
				
				
				
				
				
				
				
				
				
				
				
				
				
				null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
				</header>
				<footer enable="false" generatedate="false">
					<data value="null" />
				</footer>
				<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
			</pdf>
		<display id="" type="" style="Code" enable="true">
			<name><![CDATA[SQL Text]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select 
 REPLACE(ST.SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID AND
  ST.SQL_ID          = :SQL_ID   AND
  INSTANCE_NUMBER    = :INST_ID  AND
  SS.SNAP_ID         = :SNAP_ID  AND
  SS.PLAN_HASH_VALUE = :PLAN_HASH_VALUE]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PLAN_HASH_VALUE">
						<prompt><![CDATA[PLAN_HASH_VALUE]]></prompt>
						<tooltip><![CDATA[PLAN_HASH_VALUE]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						
						
						
						
						
						
						
						
					
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Executions]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  SNAP_ID
, PLAN_HASH_VALUE
, EXECUTIONS_DELTA EXECUTIONS
, CASE 
    WHEN (ELAPSED_TIME_DELTA/1000000) is null then ' '
    WHEN (ELAPSED_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END ELAPSED_TIME
, TO_CHAR(round((ELAPSED_TIME_DELTA/1000)/nvl(replace(EXECUTIONS_DELTA,0,1),1)),'FM999,999,990') "ELAPSED/EXEC(ms)"
, SORTS_DELTA SORTS
, ROWS_PROCESSED_DELTA ROWS_PROCESSED
, FETCHES_DELTA FETCHES
, DISK_READS_DELTA DISK_READS
, BUFFER_GETS_DELTA BUFFER_GETS
, CASE 
    WHEN (CPU_TIME_DELTA/1000000) is null then ' '
    WHEN (CPU_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00') ||'s'
    ELSE
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00') ||'s'
  END CPU_TIME
--, round(CPU_TIME_DELTA/1000000,2) CPU_TIME
, round(IOWAIT_DELTA/1000000,2) IOWAIT
, round(CLWAIT_DELTA/1000000,2) CLUSTER_WAIT
, round(CCWAIT_DELTA/1000000,2) CONCURRENCY_WAIT
, round(APWAIT_DELTA/1000000,2) APPLICATION_WAIT
, DIRECT_WRITES_DELTA DIRECT_WRITES
,   CASE
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024),2),'FM000.00') || ' MB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > 1024 THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(IO_INTERCONNECT_BYTES_DELTA,'FM9000.00') || '   '
  END IO_INTERCONNECT_BYTES
from
  DBA_HIST_SQLSTAT
where 
  INSTANCE_NUMBER = :INST_ID         AND
  SQL_ID          = :SQL_ID          AND
--PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
  SNAP_ID         = :SNAP_ID]]></sql>
				<binds>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Explain Plan]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
/*
SELECT 
  TIMESTAMP
, sp.SQL_ID
, sp.PLAN_HASH_VALUE
, LPAD('  ',2*(DEPTH-1))
  ||operation
  ||' '
  ||OPTIONS
  ||' '
  ||DECODE(id, 0, 'Cost = '
--||position
  ||
  CASE
    WHEN position >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000*1000),2),'FM999.00') || ' Q'
    WHEN position >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000),2),'FM999.00') || ' T'
    WHEN position >= (1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000),2),'FM999.00') || ' B'
    WHEN position >= (1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000),2),'FM999.00') || ' M'
    WHEN position >= 1000 THEN TO_CHAR(ROUND(position/1000,2),'FM999.00') || ' K'
    ELSE TO_CHAR(position,'FM9999') || '  '
  END
  ) "EXPLAIN PLAN"
, nvl(object_name,' ') object_name
, nvl(object_type,' ') object_type
, lpad(
  CASE
    WHEN cardinality >= 1000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000,2),'FM000.00') || ' T'
    WHEN cardinality >= 1000000000 THEN TO_CHAR(ROUND(cardinality/1000000000,2),'FM000.00') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(ROUND(cardinality/1000000,2),'FM000.00') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(ROUND(cardinality/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(cardinality,'FM000') || '     '
  END , 9 , ' ' ) AS "Rows"
, CASE
    WHEN BYTES >= (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM9000.00') || ' PB'
    WHEN BYTES >= (1024*1024*1024*1024) THEN TO_CHAR(ROUND(bytes/(1024*1024*1024*1024),2),'FM9000.00') || ' TB'
    WHEN BYTES >= (1024*1024*1024) THEN TO_CHAR(ROUND(bytes/(1024*1024*1024),2),'FM9000.00') || ' GB'
    WHEN BYTES >= (1024*1024) THEN TO_CHAR(ROUND(bytes/(1024*1024),2),'FM9000.00') || ' MB'
    WHEN BYTES >= 1024 THEN TO_CHAR(ROUND(bytes/1024,2),'FM9000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM9000') || '      '
  END BYTES
, CASE
    WHEN TEMP_SPACE >= (1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024),2),'FM9000.00') || ' TB'
    WHEN TEMP_SPACE >= (1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024),2),'FM9000.00') || ' GB'
    WHEN TEMP_SPACE >= (1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024),2),'FM9000.00') || ' MB'
    WHEN TEMP_SPACE >= 1024 THEN TO_CHAR(ROUND(TEMP_SPACE/1024,2),'FM9000.00') || ' KB'
    ELSE TO_CHAR(TEMP_SPACE,'FM9000.00') || '   '
  END TEMP_SPACE
, HS.SQL_PROFILE
, CASE
    WHEN CPU_COST >= 1000000000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000000000),'FM000') || ' T'
    WHEN CPU_COST >= 1000000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000000),'FM000') || ' B'
    WHEN CPU_COST >= 1000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000),'FM000') || ' M' 
    WHEN CPU_COST >= 1000 THEN TO_CHAR(TRUNC(CPU_COST/1000),'FM000') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM000') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST > 1000000000 THEN TO_CHAR(TRUNC(IO_COST/1000000000),'FM000') || ' B'
    WHEN IO_COST > 1000000 THEN TO_CHAR(TRUNC(IO_COST/1000000),'FM000') || ' M' 
    WHEN IO_COST > 1000 THEN TO_CHAR(TRUNC(IO_COST/1000),'FM000') || ' K'
    ELSE TO_CHAR(IO_COST,'FM000') || '  '
  END AS IO_COST
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')
  END TIME
, ACCESS_PREDICATES
, FILTER_PREDICATES
, PROJECTION
FROM
  DBA_HIST_SQL_PLAN sp,
  ( SELECT
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
    , COUNT(*) entries
    FROM
      DBA_HIST_ACTIVE_SESS_HISTORY
    WHERE
      sql_id   = :SQL_ID AND
      ( sql_exec_id
      , SQL_PLAN_HASH_VALUE) IN
      ( SELECT
          sql_exec_id
        , SQL_PLAN_HASH_VALUE
        FROM
          DBA_HIST_ACTIVE_SESS_HISTORY
        WHERE
          sql_id = :SQL_ID AND
          rownum = 1
      )
    GROUP BY
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
  ) ash
, DBA_HIST_SQLSTAT HS
WHERE
  sp.sql_id               = :SQL_ID   AND
  ash.sql_id(+)           = sp.sql_id AND
  ash.sql_plan_line_id(+) = sp.id     AND
  sp.SQL_ID               = HS.SQL_ID
ORDER BY
  TIMESTAMP
, sp.id
--, sp.plan_hash_value
*/
--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
-------- Explain Plan -------- inAWR_SQL_ID
SELECT 
  TIMESTAMP
, sp.SQL_ID
, PLAN_HASH_VALUE
, LPAD('  ',2*(DEPTH-1))
  ||operation
  ||' '
  ||OPTIONS
  ||' '
  ||DECODE(id, 0, 'Cost = '
--||position
  ||
  CASE
    WHEN position >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000*1000),2),'FM999990.00') || ' Q'
    WHEN position >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000),2),'FM999990.00') || ' T'
    WHEN position >= (1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000),2),'FM999990.00') || ' B'
    WHEN position >= (1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000),2),'FM999990.00') || ' M'
    WHEN position >= 1000 THEN TO_CHAR(ROUND(position/1000,2),'FM999990.00') || ' K'
    ELSE TO_CHAR(position,'FM999990') || '  '
  END
  ) "EXPLAIN PLAN"
, nvl(object_type,' ') object_type
, nvl(object_name,' ') object_name
, nvl(OPTIONS,' ') OPTIONS
, lpad(
  CASE
    WHEN cardinality >= 1000000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN cardinality >= 1000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000,2),'FM999000.00') || ' T'
    WHEN cardinality >= 1000000000 THEN TO_CHAR(ROUND(cardinality/1000000000,2),'FM999000.00') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(ROUND(cardinality/1000000,2),'FM999000.00') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(ROUND(cardinality/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(cardinality,'FM999000') || '     '
  END , 9 , ' ' ) AS "Rows"
, CASE
    WHEN BYTES >= (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM999000.00') || ' PB'
    WHEN BYTES >= (1024*1024*1024*1024) THEN TO_CHAR(ROUND(bytes/(1024*1024*1024*1024),2),'FM999000.00') || ' TB'
    WHEN BYTES >= (1024*1024*1024) THEN TO_CHAR(ROUND(bytes/(1024*1024*1024),2),'FM999000.00') || ' GB'
    WHEN BYTES >= (1024*1024) THEN TO_CHAR(ROUND(bytes/(1024*1024),2),'FM999000.00') || ' MB'
    WHEN BYTES >= 1024 THEN TO_CHAR(ROUND(bytes/1024,2),'FM999000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM999000.00') || '   '
  END BYTES
, CASE
    WHEN TEMP_SPACE >= (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024*1024),2),'FM000.00') || ' PB'
    WHEN TEMP_SPACE >= (1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN TEMP_SPACE >= (1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN TEMP_SPACE >= (1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024),2),'FM000.00') || ' MB'
    WHEN TEMP_SPACE >= 1024 THEN TO_CHAR(ROUND(TEMP_SPACE/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(TEMP_SPACE,'FM9000.00') || '   '
  END TEMP_SPACE
--, SQL_PROFILE
, CASE
    WHEN CPU_COST >= 1000000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN CPU_COST >= 1000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000,2),'FM999000.00') || ' T'
    WHEN CPU_COST >= 1000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000,2),'FM999000.00') || ' B'
    WHEN CPU_COST >= 1000000 THEN TO_CHAR(ROUND(CPU_COST/1000000,2),'FM999000.00') || ' M' 
    WHEN CPU_COST >= 1000 THEN TO_CHAR(ROUND(CPU_COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM999000.00') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST >= 1000000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN IO_COST >= 1000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000,2),'FM999000.00') || ' T'
    WHEN IO_COST >= 1000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000,2),'FM999000.00') || ' B'
    WHEN IO_COST >= 1000000 THEN TO_CHAR(ROUND(IO_COST/1000000,2),'FM999000.00') || ' M' 
    WHEN IO_COST >= 1000 THEN TO_CHAR(ROUND(IO_COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(IO_COST,'FM999000.00') || '  '
  END AS IO_COST
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM999999990') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')||'s'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')||'s'
  END TIME
, ACCESS_PREDICATES
, FILTER_PREDICATES
, PROJECTION
FROM
  DBA_HIST_SQL_PLAN sp
, ( SELECT
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
    , COUNT(*) entries
    FROM
      DBA_HIST_ACTIVE_SESS_HISTORY
    WHERE
    --SQL_PLAN_HASH_VALUE = :SQL_PLAN_HASH_VALUE AND
      sql_id              = :SQL_ID AND
      ( sql_exec_id
      , SQL_PLAN_HASH_VALUE) IN
      ( SELECT
          sql_exec_id
        , SQL_PLAN_HASH_VALUE
        FROM
          DBA_HIST_ACTIVE_SESS_HISTORY
        WHERE
        --SQL_PLAN_HASH_VALUE = :SQL_PLAN_HASH_VALUE AND
          sql_id              = :SQL_ID and
          rownum              = 1
      )
    GROUP BY
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
  ) ash
WHERE
  sp.sql_id               = :SQL_ID   AND
  ash.sql_id(+)           = sp.sql_id AND
  ash.sql_plan_line_id(+) = sp.id   --AND
--sp.plan_hash_value      = :PLAN_HASH_VALUE
ORDER BY
  TIMESTAMP DESC
, sp.ID]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Bind Variables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  INSTANCE_NUMBER INST_ID
, snap_id
, sql_id
, datatype_string
, position
, value_string value
, to_char(last_captured,'YYYY-MM-DD HH24:MI:SS') last_captured 
from DBA_HIST_SQLBIND
where 
  sql_id          = :SQL_ID     AND
  INSTANCE_NUMBER = :INST_ID    AND
  snap_id         = :SNAP_ID    AND
  last_captured     is not null 
order by
  position
, last_captured]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Elapsed Time History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  day
, serial
, value
from
  ( select
      to_char(s.begin_interval_time,'mm/dd') day
    , 'Elapsed time(s)' serial
    , ROUND(AVG((SQL.ELAPSED_TIME_DELTA/1000000/nvl(replace(sql.executions_delta,0,1),1) )),2) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
    GROUP BY
      to_char(s.begin_interval_time,'mm/dd')
    , sql_id 
    union all
  ( select
      to_char(s.begin_interval_time,'mm/dd') day
    , 'Executions' serial
    , SUM(sql.executions_delta) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
    GROUP BY
      to_char(s.begin_interval_time,'mm/dd')
    , sql_id
  ) 
  )
order by
  day]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[Tuning Advice]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  l_sql               VARCHAR2(500) := :SQL_ID;
  bsnap               number := :SNAP_ID;
  esnap               number := bsnap+1;
  tname               varchar2(400) := 'tuning_task_'||l_sql;
  descr               varchar2(400) := 'Tuning task for statement '||l_sql;
  l_sql_tune_task_id  varchar2(400);
  recommendations     varchar2(2000);
  RetVal              CLOB;
  MAXBUFSIZE          NUMBER := 32767;
BEGIN
  dbms_output.enable(1000000);
  l_sql_tune_task_id := dbms_sqltune.create_tuning_task ( BEGIN_SNAP=>bsnap, END_SNAP=>esnap, sql_id =>l_sql, PLAN_HASH_VALUE=>:PLAN_HASH_VALUE, time_limit =>600, task_name =>tname, description =>descr);
  begin
    DBMS_SQLTUNE.reset_tuning_task (task_name => tname);
    DBMS_SQLTUNE.execute_tuning_task(task_name => tname);
    RetVal := dbms_sqltune.report_tuning_task(l_sql_tune_task_id);
    dbms_output.put_line('<PRE>');
    dbms_output.put_line(dbms_lob.substr( RetVal, MAXBUFSIZE-1, 1 ));
    dbms_output.put_line('</PRE>');
    dbms_sqltune.DROP_TUNING_TASK(tname);
  exception 
    when others then
      dbms_output.put_line('Unable to produce report.');
      dbms_output.put_line(SQLERRM);
      dbms_sqltune.DROP_TUNING_TASK(tname);
  end; 
END;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Tables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT
  o.object_name table_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000') || '     '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000') || '     '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id          = :SQL_ID          AND
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
      sp.OBJECT_TYPE  = 'TABLE'          AND
      sp.OPERATION    = 'TABLE ACCESS'
  ) AND
  o.owner       = ts.owner      AND
  o.owner       = t.owner       AND
  o.object_name = ts.table_name AND
  ts.table_name = t.table_name  AND
  o.object_type = 'TABLE'       AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Indexes]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/26 (of last update/validation)
--- Update: 2016/08/02
--- Using LISTAGG - anlytical function introduced in database 11gR2 inplace of SUBSTR(SYS_CONNECT_BY_PATH(column_name, ', '),2) for Index column_list
------------------------------------------------------------------------------------------------------------------------------------
select
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created segment
, UNIQUENESS
, tablespace_name
, visibility
, listagg(dic.column_name, ', ') within group(order by di.owner, di.table_name, di.index_name, dic.column_position) as column_list
, CASE
    WHEN distinct_keys >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN distinct_keys >= (1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN distinct_keys >= (1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000),2),'FM000.00') || ' M'
    WHEN distinct_keys >= 1000 THEN TO_CHAR(ROUND(distinct_keys/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(distinct_keys,'FM000.00') || '  '
  END distinct_keys
, CASE
    WHEN NUM_ROWS >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN NUM_ROWS >= (1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN NUM_ROWS >= (1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000),2),'FM000.00') || ' M'
    WHEN NUM_ROWS >= 1000 THEN TO_CHAR(ROUND(NUM_ROWS/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(NUM_ROWS,'FM000.00') || '  '
  END NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') created
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') LAST_DDL_TIME
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') last_analyzed
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' LOGGING;'
    ELSE NULL
  END  "ALTER INDEX"
from
      dba_ind_columns dic
    , dba_indexes di
    , dba_ind_expressions die
    , dba_objects do
    WHERE 
    --(dic.table_name       like trim(upper(:TABLE_NAME)) or instr(dic.TABLE_NAME, trim(upper(:TABLE_NAME))) > 0) AND -- do not delete this line even if it is commented
    --dic.table_name      = trim(upper(:TABLE_NAME)) AND
      do.object_type      = 'INDEX'                  AND
      dic.index_name      = di.index_name            AND
      dic.index_name      = die.index_name(+)        AND
      dic.COLUMN_POSITION = die.COLUMN_POSITION(+)   AND
      dic.index_owner     = do.owner                 AND
      dic.index_name      = do.object_name           AND
      do.object_name        IN
      ( SELECT
          o.object_name
        FROM
          dba_objects o
        WHERE
        ( o.object_name) IN
        ( SELECT
            sp.object_name
          FROM
            DBA_HIST_SQL_PLAN sp
          WHERE
            sql_id          = :SQL_ID          AND
            PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
            sp.operation      like '%INDEX%'   AND
            sp.object_type    IS NOT NULL
        ) 
      )
group by
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created
, UNIQUENESS
, tablespace_name
, visibility
, distinct_keys
, NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
order by
  di.table_name
, di.index_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Stats History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[WITH TABLE_LIST AS
(
--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT
  o.object_name table_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000') || '     '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000') || '     '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id          = :SQL_ID          AND
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
      sp.OBJECT_TYPE  = 'TABLE'          AND
      sp.OPERATION    = 'TABLE ACCESS'
  ) AND
  o.owner       = ts.owner      AND
  o.owner       = t.owner       AND
  o.object_name = ts.table_name AND
  ts.table_name = t.table_name  AND
  o.object_type = 'TABLE'       AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name
  )
--------------------------------------------------------------------------------------------------------------------------------
/*
Created: Anand Mahajani, 2018/03/13
*/
select
  OWNER
, TABLE_NAME
, STATS_UPDATE_TIME
, PARTITION_NAME
, SUBPARTITION_NAME
, 'EXECUTE DBMS_STATS.RESTORE_TABLE_STATS(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',AS_OF_TIMESTAMP=>'||''''||STATS_UPDATE_TIME||''''||');' "RESTORE TABLE STATS"
, 'SELECT * FROM TABLE(DBMS_STATS.DIFF_TABLE_STATS_IN_HISTORY(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',TIME1=>'||''''||STATS_UPDATE_TIME||''''||',TIME2=>'||''''||LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)||''''||',pctthreshold =>10));' "STATS DIFF"
from
  DBA_TAB_STATS_HISTORY
where
  table_name in (select table_name from TABLE_LIST)
order by
  TABLE_NAME
, STATS_UPDATE_TIME DESC]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Views]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, v.text
from
  dba_objects o
, dba_views v
where
  ( o.object_id
  , o.object_name) in
  ( select
      sp.OBJECT#
    , sp.object_name
    from
      DBA_HIST_SQL_PLAN sp
    where
      sql_id = :SQL_ID
  ) and
  o.owner       = v.owner     AND
  o.object_name = v.view_name AND
  o.object_type = 'VIEW'      AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[ASH SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  BIT      date;
  EIT      date;
  dbid     number;
  start_id number;
  end_id   number;
  inst_id  number;
begin
  select distinct dbid into dbid from v$database;
  start_id := to_number(:SNAP_ID-1);
  end_id   := to_number(start_id+4);
  inst_id  := :INST_ID;
  select BEGIN_INTERVAL_TIME into BIT from DBA_HIST_SNAPSHOT where SNAP_ID = start_id and INSTANCE_NUMBER = inst_id;
  select END_INTERVAL_TIME into EIT from DBA_HIST_SNAPSHOT where SNAP_ID = end_id and INSTANCE_NUMBER = inst_id;
  dbms_output.enable(500000);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.ash_report_text( dbid,inst_id,BIT, EIT, L_SQL_ID=>:SQL_ID))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>') ;
end;]]></sql>
				<binds>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[AWR SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select output from table(dbms_workload_repository.AWR_SQL_REPORT_TEXT( (select dbid from v$database),
                                                            :INST_ID,
                                                            :SNAP_ID-3, :SNAP_ID+1,
                                                            :SQL_ID ))]]></sql>
				<binds>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[AWR]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  dbid     number;
  start_id number;
  end_id   number;
begin
  dbms_output.enable(1000000);
  select distinct dbid into dbid from gv$database;
  start_id := to_number(:SNAP_ID-3);
  end_id   := to_number(start_id+4);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.awr_report_text(dbid,:INST_ID,start_id,end_id))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>');
end;]]></sql>
				<binds>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Wait Events]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<STYLE><![CDATA[Default]]></STYLE>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
				<GRID_WIDTH><![CDATA[THINNER]]></GRID_WIDTH>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT DISTINCT
  TO_CHAR(sample_time,'HH24:MI') end_time
, event
, COUNT(*) sample_count
FROM
--gv$active_session_history
  DBA_HIST_ACTIVE_SESS_HISTORY
WHERE
  SNAP_ID = :SNAP_ID AND
  SQL_ID  = :SQL_ID AND
  event     IS NOT NULL
GROUP BY
  ( sample_time,'HH24:MI' )
, event
ORDER BY
  end_time]]></sql>
				<binds>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Segment Waits]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT
  TO_CHAR(TRUNC(ash.sample_time,'MI'),'hh24:mi') TIME
, o.object_name object_name
, COUNT(ash.time_waited) sample_count
FROM
  dba_objects o
, DBA_HIST_ACTIVE_SESS_HISTORY ash
--, gv$active_session_history ash
WHERE
  SQL_ID         = :SQL_ID          AND
  SNAP_ID        = :SNAP_ID         AND
  o.object_id    = ash.current_obj# AND
  ash.time_waited  IS NOT NULL
GROUP BY
  TRUNC(ash.sample_time,'MI')
, o.object_name
ORDER BY
  TRUNC(ash.sample_time,'MI')
, o.object_name]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[XPLAN]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
--- Update: 2016/08/09
/*
select
  'select * from table(dbms_xplan.display_awr('||''''||:SQL_ID||''''||'));'
from
  dual */
select * from table(dbms_xplan.display_awr(:SQL_ID))]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
	</display>
	<display id="f4e8d84d-014e-1000-8006-0a6e20488410" type="" style="Table" enable="true">
		<name><![CDATA[01. DailyTop20]]></name>
		<description><![CDATA[]]></description>
		<tooltip><![CDATA[]]></tooltip>
		<drillclass><![CDATA[]]></drillclass>
		<CustomValues>
			<TYPE><![CDATA[horizontal]]></TYPE>
		</CustomValues>
		<query>
			<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select * from
  ( SELECT
      STAT.INSTANCE_NUMBER INST_ID
    , STAT.SNAP_ID
    , STAT.SQL_ID SQL_ID
    , PLAN_HASH_VALUE
    , case
        when instr(STAT.module,'@',1,1) > 0 then substr(STAT.module, 1, instr(STAT.module,'@',1,1)-1)
        when instr(STAT.module,'.',-1,1) > 0 then substr(STAT.module, 1, instr(STAT.module,'.',-1,1)-1)
      else
        STAT.module
      end module
    , nvl(ACTION, '(null)') ACTION
    , CASE 
        WHEN ELAPSED_TIME_DELTA is null then ' '
        WHEN ELAPSED_TIME_DELTA/1000000 > 3600*24 then
          TO_CHAR(TRUNC(ELAPSED_TIME_DELTA/1000000/3600/24),'FM990') || 'd ' ||
          TO_CHAR(TRUNC(MOD(ELAPSED_TIME_DELTA/1000000,3600*24)/3600),'FM90')|| 'h:' ||
          TO_CHAR(TRUNC(MOD(ELAPSED_TIME_DELTA/1000000,3600)/60),'FM00') || 'm:' ||
          TO_CHAR(MOD(ELAPSED_TIME_DELTA/1000000,60),'FM00.00')|| 's'
        ELSE
          TO_CHAR(TRUNC(ELAPSED_TIME_DELTA/1000000/3600),'FM90') || 'h:' ||
          TO_CHAR(TRUNC(MOD(ELAPSED_TIME_DELTA/1000000,3600)/60),'FM00') || 'm:' ||
          TO_CHAR(MOD(ELAPSED_TIME_DELTA/1000000,60),'FM00.00')|| 's'
      END ELAPSED_TIME
    , EXECUTIONS_DELTA EXECUTIONS
    , ROWS_PROCESSED_DELTA ROWS_PROCESSED
    , STAT.OPTIMIZER_COST
    , STAT.DISK_READS_DELTA DISK_READS
    , to_char(SS.BEGIN_INTERVAL_TIME, 'DY DD-MON-YYYY HH:MI:SS AM') BEGIN_INTERVAL
    , to_char(SS.END_INTERVAL_TIME, 'DY DD-MON-YYYY HH:MI:SS AM') END_INTERVAL
    --, PARSING_SCHEMA_NAME PARSING_SCHEMA
    --, REPLACE(SQL_TEXT,chr(0)) SQL_TEXT
    FROM
      DBA_HIST_SQLSTAT STAT
    , DBA_HIST_SQLTEXT TXT
    , DBA_HIST_SNAPSHOT SS
    WHERE
      STAT.SQL_ID                  = TXT.SQL_ID AND
      STAT.DBID                    = TXT.DBID AND
      SS.DBID                      = STAT.DBID AND
      SS.INSTANCE_NUMBER           = STAT.INSTANCE_NUMBER AND
      STAT.SNAP_ID                 = SS.SNAP_ID AND
      EXECUTIONS_DELTA            <= 2 AND
      ELAPSED_TIME_DELTA/1000000  >= 5 AND
      PARSING_SCHEMA_NAME            not in ('SYS', 'SYSTEM', 'DBSNMP', 'SYSMAN') AND
      SQL_TEXT                       not like '%dbms_stats%' AND
      MODULE                         not in ('DBMS_SCHEDULER', 'SQL Developer', 'Data Pump Worker','SQL*Plus') AND
      MODULE                         not like 'TOAD%' AND
      ACTION                         not like 'EMSTATSUPD%' AND
      SS.BEGIN_INTERVAL_TIME         between trunc(sysdate-3) and trunc(sysdate)
      --to_date(to_char(SS.BEGIN_INTERVAL_TIME, 'MM-DD-YYYY HH24:MI:SS'), 'MM-DD-YYYY HH24:MI:SS') between trunc(sysdate-1) and trunc(sysdate)
    ORDER BY
      ELAPSED_TIME_DELTA desc)
  where rownum < 21]]></sql>
		</query>
			<pdf version="VERSION_1_7" compression="CONTENT">
				<docproperty title="Monitor Batch" author="Anand Mahajani" subject="Daily Top 20" keywords="" />
				<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
				<column>
					<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
					<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
					<blob blob="NONE" zip="false" />
				</column>
				<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
				<header enable="true" generatedate="true">
					<data>
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:36:48 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									</data>
					<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:36:48 AM" />
				</header>
				<footer enable="true" generatedate="true">
					<data value="null" />
					<pattern pattern="#" position="6" value="1" />
				</footer>
				<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
			</pdf>
		<display id="" type="" style="Code" enable="true">
			<name><![CDATA[SQL Text]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select 
 REPLACE(ST.SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID        AND
  SS.SQL_ID          = :SQL_ID          AND 
  SS.INSTANCE_NUMBER = :INST_ID         AND
  SS.PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
  SS.SNAP_ID         = :SNAP_ID]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PLAN_HASH_VALUE">
						<prompt><![CDATA[PLAN_HASH_VALUE]]></prompt>
						<tooltip><![CDATA[PLAN_HASH_VALUE]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="SQL Text" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:38:38 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:38:38 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Executions]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  SNAP_ID
, SQL_ID
, PLAN_HASH_VALUE
, EXECUTIONS_DELTA EXECUTIONS
, CASE 
    WHEN (ELAPSED_TIME_DELTA/1000000) is null then ' '
    WHEN (ELAPSED_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END ELAPSED_TIME
, TO_CHAR(round((ELAPSED_TIME_DELTA/1000)/nvl(replace(EXECUTIONS_DELTA,0,1),1)),'FM999,999,990') "ELAPSED/EXEC(ms)"
, FETCHES_DELTA FETCHES
, ROWS_PROCESSED_TOTAL ROWS_PROCESSED
, SORTS_DELTA SORTS
, DISK_READS_DELTA DISK_READS
, BUFFER_GETS_DELTA BUFFER_GETS
, CASE 
    WHEN (CPU_TIME_DELTA/1000000) is null then ' '
    WHEN (CPU_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END CPU_TIME
--, round(CPU_TIME_DELTA/1000000,2) CPU_TIME
, round(IOWAIT_DELTA/1000000,2) IOWAIT
, round(CLWAIT_DELTA/1000000,2) CLUSTER_WAIT
, round(CCWAIT_DELTA/1000000,2) CONCURRENCY_WAIT
, round(APWAIT_DELTA/1000000,2) APPLICATION_WAIT
, DIRECT_WRITES_DELTA DIRECT_WRITES
,   CASE
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024),2),'FM000.00') || ' MB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > 1024 THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(IO_INTERCONNECT_BYTES_DELTA,'FM9000.00') || '   '
  END IO_INTERCONNECT_BYTES
from DBA_HIST_SQLSTAT
where 
  INSTANCE_NUMBER = :INST_ID AND
  SQL_ID          = :SQL_ID  AND
--PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
  SNAP_ID         = :SNAP_ID]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Executions" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:40:31 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:40:31 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Explain Plan]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT 
  TIMESTAMP
, PLAN_HASH_VALUE
, LPAD('  ',2*(DEPTH-1))
  ||operation
  ||' '
  ||OPTIONS
  ||' '
  ||DECODE(id, 0, 'Cost = '
--||position
  ||
  CASE
    WHEN position >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000*1000),2),'FM999.00') || ' Q'
    WHEN position >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000),2),'FM999.00') || ' T'
    WHEN position >= (1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000),2),'FM999.00') || ' B'
    WHEN position >= (1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000),2),'FM999.00') || ' M'
    WHEN position >= 1000 THEN TO_CHAR(ROUND(position/1000,2),'FM999.00') || ' K'
    ELSE TO_CHAR(position,'FM9999') || '  '
  END
  ) "EXPLAIN PLAN"
, nvl(object_name,' ') object_name
, nvl(object_type,' ') object_type
, lpad(
  CASE
    WHEN cardinality >= 1000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000,2),'FM000.00') || ' T'
    WHEN cardinality >= 1000000000 THEN TO_CHAR(ROUND(cardinality/1000000000,2),'FM000.00') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(ROUND(cardinality/1000000,2),'FM000.00') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(ROUND(cardinality/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(cardinality,'FM000') || '     '
  END , 9 , ' ' ) AS "Rows"
, CASE
    WHEN BYTES > (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM000.00') || ' PB'
    WHEN BYTES > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN BYTES > (1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN BYTES > (1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024),2),'FM000.00') || ' MB'
    WHEN BYTES > 1024 THEN TO_CHAR(ROUND(BYTES/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM9000.00') || '   '
  END BYTES
, CASE
    WHEN TEMP_SPACE > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN TEMP_SPACE > (1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN TEMP_SPACE > (1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024),2),'FM000.00') || ' MB'
    WHEN TEMP_SPACE > 1024 THEN TO_CHAR(ROUND(TEMP_SPACE/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(TEMP_SPACE,'FM9000.00') || '   '
  END TEMP_SPACE
, CASE
    WHEN CPU_COST > 1000000000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000000000),'FM000') || ' T'
    WHEN CPU_COST > 1000000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000000),'FM000') || ' B'
    WHEN CPU_COST > 1000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000),'FM000') || ' M' 
    WHEN CPU_COST > 1000 THEN TO_CHAR(TRUNC(CPU_COST/1000),'FM000') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM000') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST > 1000000000 THEN TO_CHAR(TRUNC(IO_COST/1000000000),'FM000') || ' B'
    WHEN IO_COST > 1000000 THEN TO_CHAR(TRUNC(IO_COST/1000000),'FM000') || ' M' 
    WHEN IO_COST > 1000 THEN TO_CHAR(TRUNC(IO_COST/1000),'FM000') || ' K'
    ELSE TO_CHAR(IO_COST,'FM000') || '  '
  END AS IO_COST
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
  END TIME
, ACCESS_PREDICATES
, FILTER_PREDICATES
, PROJECTION
FROM 
  DBA_HIST_SQL_PLAN sp,
  ( SELECT
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
    , COUNT(*) entries
    FROM
      DBA_HIST_ACTIVE_SESS_HISTORY
    WHERE
      sql_id   = :SQL_ID AND
      ( sql_exec_id
      , SQL_PLAN_HASH_VALUE) IN
      ( SELECT
          sql_exec_id
        , SQL_PLAN_HASH_VALUE
        FROM
          DBA_HIST_ACTIVE_SESS_HISTORY
        WHERE
          sql_id = :SQL_ID AND
          rownum = 1
      )
    GROUP BY
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
  ) ash
WHERE
  sp.sql_id               = :SQL_ID   AND
  ash.sql_id(+)           = sp.sql_id AND
  ash.sql_plan_line_id(+) = sp.id
ORDER BY
  TIMESTAMP DESC
, sp.id
/*
  sp.plan_hash_value
, sp.id
*/]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Explain Plan" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:42:25 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:42:25 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Bind Variables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  INSTANCE_NUMBER
, snap_id
, sql_id
, datatype_string
, position
, value_string value
, to_char(last_captured,'YYYY-MM-DD HH24:MI:SS') last_captured 
from DBA_HIST_SQLBIND
where 
  last_captured     is not null and 
  sql_id          = :SQL_ID     and
  INSTANCE_NUMBER = :INST_ID    and
  snap_id         = :SNAP_ID
order by
  position
, last_captured]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Bind Variables" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:44:43 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:44:43 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Elapsed Time History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  day
, serial
, value
from
  ( select
      to_char(s.begin_interval_time,'mm/dd') day
    , 'Elapsed time(s)' serial
    , ROUND(AVG((SQL.ELAPSED_TIME_DELTA/1000000/nvl(replace(sql.executions_delta,0,1),1) )),2) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
    GROUP BY
      to_char(s.begin_interval_time,'mm/dd')
    , sql_id 
    union all
  ( select
      to_char(s.begin_interval_time,'mm/dd') day
    , 'Executions' serial
    , SUM(sql.executions_delta) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
   GROUP BY
     to_char(s.begin_interval_time,'mm/dd')
   , sql_id
  ) 
  )
order by
  day]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Elapsed Time History" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:46:21 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:46:21 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[Tuning Advice]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  l_sql               VARCHAR2(500) := :SQL_ID;
  bsnap               number := :SNAP_ID;
  esnap               number := bsnap+1;
  tname               varchar2(400) := 'tuning_task_'||l_sql;
  descr               varchar2(400) := 'Tuning task for statement '||l_sql;
  l_sql_tune_task_id  varchar2(400);
  recommendations     varchar2(2000);
  RetVal              CLOB;
  MAXBUFSIZE          NUMBER := 32767;
BEGIN
  dbms_output.enable(1000000);
  l_sql_tune_task_id := dbms_sqltune.create_tuning_task ( BEGIN_SNAP=>bsnap, END_SNAP=>esnap, sql_id =>l_sql, PLAN_HASH_VALUE=>:PLAN_HASH_VALUE, time_limit =>1200, task_name =>tname, description =>descr);
  begin
    DBMS_SQLTUNE.reset_tuning_task (task_name => tname);
    DBMS_SQLTUNE.execute_tuning_task(task_name => tname);
    RetVal := dbms_sqltune.report_tuning_task(l_sql_tune_task_id);
    dbms_output.put_line('<PRE>');
    dbms_output.put_line(dbms_lob.substr( RetVal, MAXBUFSIZE-1, 1 ));
    dbms_output.put_line('</PRE>');
    dbms_sqltune.DROP_TUNING_TASK(tname);
  exception 
    when others then
      dbms_output.put_line('Unable to produce report.');
      dbms_output.put_line(SQLERRM);
      dbms_sqltune.DROP_TUNING_TASK(tname);
  end; 
END;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Tuning Advice" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:48:13 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:48:13 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Tables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT
  o.object_name TABLE_NANE
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000.00') || '  '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000.00') || '  '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id          = :SQL_ID and
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE
  ) AND
  o.owner       = ts.owner      AND
  o.owner       = t.owner       AND
  o.object_name = ts.table_name AND
  ts.table_name = t.table_name  AND
  o.object_type = 'TABLE'       AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Tables usage" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:50:28 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:50:28 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Indexes]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/26 (of last update/validation)
--- Update: 2016/08/02
--- Using LISTAGG - anlytical function introduced in database 11gR2 inplace of SUBSTR(SYS_CONNECT_BY_PATH(column_name, ', '),2) for Index column_list
------------------------------------------------------------------------------------------------------------------------------------
select
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created segment
, UNIQUENESS
, tablespace_name
, visibility
, listagg(dic.column_name, ', ') within group(order by di.owner, di.table_name, di.index_name, dic.column_position) as column_list
, CASE
    WHEN distinct_keys >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN distinct_keys >= (1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN distinct_keys >= (1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000),2),'FM000.00') || ' M'
    WHEN distinct_keys >= 1000 THEN TO_CHAR(ROUND(distinct_keys/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(distinct_keys,'FM000.00') || '  '
  END distinct_keys
, CASE
    WHEN NUM_ROWS >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN NUM_ROWS >= (1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN NUM_ROWS >= (1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000),2),'FM000.00') || ' M'
    WHEN NUM_ROWS >= 1000 THEN TO_CHAR(ROUND(NUM_ROWS/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(NUM_ROWS,'FM000.00') || '  '
  END NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') created
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') LAST_DDL_TIME
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') last_analyzed
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
, CASE
    WHEN DEGREE <> '1' or INSTANCES <> '1' AND LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL LOGGING;'
    WHEN DEGREE <> '1' or INSTANCES <> '1' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' LOGGING;'
    ELSE NULL
  END  "ALTER INDEX"
from
      dba_ind_columns dic
    , dba_indexes di
    , dba_ind_expressions die
    , dba_objects do
    WHERE 
    --(dic.table_name       like trim(upper(:TABLE_NAME)) or instr(dic.TABLE_NAME, trim(upper(:TABLE_NAME))) > 0) AND -- do not delete this line even if it is commented
    --dic.table_name      = trim(upper(:TABLE_NAME)) AND
      do.object_type      = 'INDEX'                  AND
      dic.index_name      = di.index_name            AND
      dic.index_name      = die.index_name(+)        AND
      dic.COLUMN_POSITION = die.COLUMN_POSITION(+)   AND
      dic.index_owner     = do.owner                 AND
      dic.index_name      = do.object_name           AND
      do.object_name        IN
      ( SELECT
          o.object_name
        FROM
          dba_objects o
        WHERE
        ( o.object_name) IN
        ( SELECT
            sp.object_name
          FROM
            DBA_HIST_SQL_PLAN sp
          WHERE
            sql_id          = :SQL_ID          AND
            PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
            sp.operation      like '%INDEX%'   AND
            sp.object_type    IS NOT NULL
        ) 
      )
group by
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created
, UNIQUENESS
, tablespace_name
, visibility
, distinct_keys
, NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
order by
  di.table_name
, di.index_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Index usage" keywords="" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Stats History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--Select 'Work In Progress' From dual
with TABLE_LIST as
(
--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT
  o.object_name TABLE_NAME
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000.00') || '  '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000.00') || '  '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id          = :SQL_ID and
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE
  ) AND
  o.owner       = ts.owner      AND
  o.owner       = t.owner       AND
  o.object_name = ts.table_name AND
  ts.table_name = t.table_name  AND
  o.object_type = 'TABLE'       AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name
  )
--------------------------------------------------------------------------------------------------------------------------------
/*
Created: Anand Mahajani, 2018/03/13

select
  OWNER
, TABLE_NAME
, LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME) PREV_STATS_UPDATE_TIME
, STATS_UPDATE_TIME
, PARTITION_NAME
, SUBPARTITION_NAME
--, 'EXECUTE DBMS_STATS.RESTORE_TABLE_STATS(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',AS_OF_TIMESTAMP=>'||''''||STATS_UPDATE_TIME||''''||');' "RESTORE TABLE STATS"
, 'EXECUTE DBMS_STATS.RESTORE_TABLE_STATS(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',AS_OF_TIMESTAMP=>'||''''||LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)||''''||');' "RESTORE TABLE STATS"
, 'SELECT * FROM TABLE(DBMS_STATS.DIFF_TABLE_STATS_IN_HISTORY(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',TIME1=>'||''''||STATS_UPDATE_TIME||''''||',TIME2=>'||''''||LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)||''''||',pctthreshold =>10));' "STATS DIFF"
from
  DBA_TAB_STATS_HISTORY
where
  table_name in (select table_name from table_list)
order by
  TABLE_NAME
, STATS_UPDATE_TIME
*/
select
  OWNER
, TABLE_NAME
, LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME, STATS_UPDATE_TIME) AS PREV_STATS_UPDATE_TIME
, STATS_UPDATE_TIME
, PARTITION_NAME
, SUBPARTITION_NAME
, 'EXECUTE DBMS_STATS.RESTORE_TABLE_STATS(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',AS_OF_TIMESTAMP=>'||''''||LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)||''''||');' "RESTORE TABLE STATS"
, 'SELECT * FROM TABLE(DBMS_STATS.diff_table_stats_in_history(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',TIME1=>'||''''||STATS_UPDATE_TIME||''''||',TIME2=>'||''''||LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)||''''||',pctthreshold => 0));' "COMPARE TABLE STATS"
from
  DBA_TAB_STATS_HISTORY
where
  table_name in (select table_name from TABLE_LIST)
order by
  TABLE_NAME
, LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)
, STATS_UPDATE_TIME;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Stats History" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:53:07 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:53:07 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Views]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, v.text
from
  dba_objects o
, dba_views v
where
  ( o.object_id
  , o.object_name) in
  ( select
      sp.OBJECT#
    , sp.object_name
    from
      DBA_HIST_SQL_PLAN sp
    where 
      sql_id = :SQL_ID
  ) and
  o.owner       = v.owner     and
  o.object_name = v.view_name and
  o.object_type = 'VIEW' and
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Views Used" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:55:15 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:55:15 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[ASH SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  BIT      date;
  EIT      date;
  dbid     number;
  start_id number;
  end_id   number;
  inst_id  number;
begin
  select distinct dbid into dbid from v$database;
  start_id := to_number(:SNAP_ID-1);
  end_id   := to_number(start_id+4);
  inst_id  := :INST_ID;
  select BEGIN_INTERVAL_TIME into BIT from DBA_HIST_SNAPSHOT where SNAP_ID = start_id and INSTANCE_NUMBER = inst_id;
  select END_INTERVAL_TIME into EIT from DBA_HIST_SNAPSHOT where SNAP_ID = end_id and INSTANCE_NUMBER = inst_id;
  dbms_output.enable(500000);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.ash_report_text( dbid,inst_id,BIT, EIT, L_SQL_ID=>:SQL_ID))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>') ;
end;]]></sql>
				<binds>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="ASH SQL" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 9:56:53 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 9:56:53 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[AWR SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select output from table(dbms_workload_repository.AWR_SQL_REPORT_TEXT( (select dbid from v$database),
                                                            :INST_ID,
                                                            :SNAP_ID-3, :SNAP_ID+1,
                                                            :SQL_ID ))]]></sql>
				<binds>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="AWR SQL" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 10:01:24 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 10:01:24 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[AWR]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  dbid     number;
  start_id number;
  end_id   number;
begin
  dbms_output.enable(1000000);
  select distinct dbid into dbid from gv$database;
  start_id := to_number(:SNAP_ID-3);
  end_id   := to_number(start_id+4);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.awr_report_text(dbid,:INST_ID,start_id,end_id))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>');
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="AWR" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 10:02:44 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 10:02:44 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Wait Events]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<PLOT_HGRID_WIDTH><![CDATA[THINNER]]></PLOT_HGRID_WIDTH>
				<Y1AXIS_SCALE_INCREMENT><![CDATA[20.0]]></Y1AXIS_SCALE_INCREMENT>
				<Y2AXIS_SCALE_MAXIMUM><![CDATA[80.0]]></Y2AXIS_SCALE_MAXIMUM>
				<Y1AXIS_LINE_WIDTH><![CDATA[THINNEST]]></Y1AXIS_LINE_WIDTH>
				<Y1AXIS_TITLE_ALIGNMENT><![CDATA[CENTER]]></Y1AXIS_TITLE_ALIGNMENT>
				<LEGEND_LOCATION><![CDATA[AUTOMATIC]]></LEGEND_LOCATION>
				<LEGEND_ALIGNMENT><![CDATA[LEFT]]></LEGEND_ALIGNMENT>
				<PLOT_DATALABELS_SLICE_POSITION><![CDATA[OUTSIDE_SLICE_LINE]]></PLOT_DATALABELS_SLICE_POSITION>
				<XAXIS_LINE_WIDTH><![CDATA[THINNEST]]></XAXIS_LINE_WIDTH>
				<Y1AXIS_SCALE_MAXIMUM><![CDATA[70.0]]></Y1AXIS_SCALE_MAXIMUM>
				<XAXIS_TITLE_ALIGNMENT><![CDATA[CENTER]]></XAXIS_TITLE_ALIGNMENT>
				<XAXIS_TICK_LABEL_ROTATE><![CDATA[HORIZONTAL]]></XAXIS_TICK_LABEL_ROTATE>
				<Y1AXIS_LOGARITHMIC_BASE><![CDATA[BASE_10]]></Y1AXIS_LOGARITHMIC_BASE>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
				<GRID_WIDTH><![CDATA[THINNER]]></GRID_WIDTH>
				<PLOT_DATALABELS_BAR_POSITION><![CDATA[ABOVE]]></PLOT_DATALABELS_BAR_POSITION>
				<FOOTNOTE_ALIGNMENT><![CDATA[LEFT]]></FOOTNOTE_ALIGNMENT>
				<XAXIS_TICK_LABEL_SKIP_MODE><![CDATA[AUTOMATIC]]></XAXIS_TICK_LABEL_SKIP_MODE>
				<Y2AXIS_LOGARITHMIC_BASE><![CDATA[BASE_10]]></Y2AXIS_LOGARITHMIC_BASE>
				<STYLE><![CDATA[Default]]></STYLE>
				<TITLE_ALIGNMENT><![CDATA[LEFT]]></TITLE_ALIGNMENT>
				<XAXIS_SCALE_INCREMENT><![CDATA[20.0]]></XAXIS_SCALE_INCREMENT>
				<PLOT_DATALABELS_SLICE_TYPE><![CDATA[PERCENT_VALUE]]></PLOT_DATALABELS_SLICE_TYPE>
				<Y2AXIS_TICK_LABEL_ROTATE><![CDATA[HORIZONTAL]]></Y2AXIS_TICK_LABEL_ROTATE>
				<Y2AXIS_SCALE_MINIMUM><![CDATA[10.0]]></Y2AXIS_SCALE_MINIMUM>
				<Y2AXIS_LINE_WIDTH><![CDATA[THINNEST]]></Y2AXIS_LINE_WIDTH>
				<Y1AXIS_TICK_LABEL_ROTATE><![CDATA[HORIZONTAL]]></Y1AXIS_TICK_LABEL_ROTATE>
				<Y2AXIS_SCALE_INCREMENT><![CDATA[20.0]]></Y2AXIS_SCALE_INCREMENT>
				<PLOT_VGRID_WIDTH><![CDATA[THINNER]]></PLOT_VGRID_WIDTH>
				<Y2AXIS_TITLE_ALIGNMENT><![CDATA[CENTER]]></Y2AXIS_TITLE_ALIGNMENT>
				<SUBTITLE_ALIGNMENT><![CDATA[LEFT]]></SUBTITLE_ALIGNMENT>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT DISTINCT
  TO_CHAR(sample_time,'HH24:MI') end_time
, event
, COUNT(*) sample_count
FROM 
  DBA_HIST_ACTIVE_SESS_HISTORY
WHERE
  SNAP_ID = :SNAP_ID AND
  SQL_ID  = :SQL_ID  AND
  event     IS NOT NULL
GROUP BY
  (sample_time,'HH24:MI')
, event
ORDER BY end_time]]></sql>
				<binds>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Wait Events" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 10:04:37 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 10:04:37 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Segment Waits]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<PLOT_HGRID_WIDTH><![CDATA[THINNER]]></PLOT_HGRID_WIDTH>
				<Y1AXIS_SCALE_INCREMENT><![CDATA[20.0]]></Y1AXIS_SCALE_INCREMENT>
				<Y2AXIS_SCALE_MAXIMUM><![CDATA[80.0]]></Y2AXIS_SCALE_MAXIMUM>
				<Y1AXIS_LINE_WIDTH><![CDATA[THINNEST]]></Y1AXIS_LINE_WIDTH>
				<Y1AXIS_TITLE_ALIGNMENT><![CDATA[CENTER]]></Y1AXIS_TITLE_ALIGNMENT>
				<LEGEND_LOCATION><![CDATA[AUTOMATIC]]></LEGEND_LOCATION>
				<LEGEND_ALIGNMENT><![CDATA[LEFT]]></LEGEND_ALIGNMENT>
				<PLOT_DATALABELS_SLICE_POSITION><![CDATA[OUTSIDE_SLICE_LINE]]></PLOT_DATALABELS_SLICE_POSITION>
				<XAXIS_LINE_WIDTH><![CDATA[THINNEST]]></XAXIS_LINE_WIDTH>
				<Y1AXIS_SCALE_MAXIMUM><![CDATA[70.0]]></Y1AXIS_SCALE_MAXIMUM>
				<XAXIS_TITLE_ALIGNMENT><![CDATA[CENTER]]></XAXIS_TITLE_ALIGNMENT>
				<XAXIS_TICK_LABEL_ROTATE><![CDATA[HORIZONTAL]]></XAXIS_TICK_LABEL_ROTATE>
				<Y1AXIS_LOGARITHMIC_BASE><![CDATA[BASE_10]]></Y1AXIS_LOGARITHMIC_BASE>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
				<GRID_WIDTH><![CDATA[THINNER]]></GRID_WIDTH>
				<PLOT_DATALABELS_BAR_POSITION><![CDATA[ABOVE]]></PLOT_DATALABELS_BAR_POSITION>
				<FOOTNOTE_ALIGNMENT><![CDATA[LEFT]]></FOOTNOTE_ALIGNMENT>
				<XAXIS_TICK_LABEL_SKIP_MODE><![CDATA[AUTOMATIC]]></XAXIS_TICK_LABEL_SKIP_MODE>
				<Y2AXIS_LOGARITHMIC_BASE><![CDATA[BASE_10]]></Y2AXIS_LOGARITHMIC_BASE>
				<STYLE><![CDATA[Default]]></STYLE>
				<TITLE_ALIGNMENT><![CDATA[LEFT]]></TITLE_ALIGNMENT>
				<XAXIS_SCALE_INCREMENT><![CDATA[20.0]]></XAXIS_SCALE_INCREMENT>
				<PLOT_DATALABELS_SLICE_TYPE><![CDATA[PERCENT_VALUE]]></PLOT_DATALABELS_SLICE_TYPE>
				<Y2AXIS_TICK_LABEL_ROTATE><![CDATA[HORIZONTAL]]></Y2AXIS_TICK_LABEL_ROTATE>
				<Y2AXIS_SCALE_MINIMUM><![CDATA[10.0]]></Y2AXIS_SCALE_MINIMUM>
				<Y2AXIS_LINE_WIDTH><![CDATA[THINNEST]]></Y2AXIS_LINE_WIDTH>
				<Y1AXIS_TICK_LABEL_ROTATE><![CDATA[HORIZONTAL]]></Y1AXIS_TICK_LABEL_ROTATE>
				<Y2AXIS_SCALE_INCREMENT><![CDATA[20.0]]></Y2AXIS_SCALE_INCREMENT>
				<PLOT_VGRID_WIDTH><![CDATA[THINNER]]></PLOT_VGRID_WIDTH>
				<Y2AXIS_TITLE_ALIGNMENT><![CDATA[CENTER]]></Y2AXIS_TITLE_ALIGNMENT>
				<SUBTITLE_ALIGNMENT><![CDATA[LEFT]]></SUBTITLE_ALIGNMENT>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT
  TO_CHAR(TRUNC(ash.sample_time,'MI'),'hh24:mi') TIME
, o.object_name object_name
, COUNT(ash.time_waited) sample_count
FROM
  dba_objects o
, DBA_HIST_ACTIVE_SESS_HISTORY ash
WHERE
  SQL_ID          = :SQL_ID          AND
  SNAP_ID         = :SNAP_ID         AND
  o.object_id     = ash.current_obj# AND
  ash.time_waited   IS NOT NULL
GROUP BY
  TRUNC(ash.sample_time,'MI')
, o.object_name
ORDER BY
  TRUNC(ash.sample_time,'MI')
, o.object_name]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="Segment Waits" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 10:05:56 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 10:05:56 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
		<display id="" type="" style="Code" enable="true">
			<name><![CDATA[XPLAN]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  'select * from table(dbms_xplan.display_awr('||''''||:SQL_ID||''''||'));'
from
  dual]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="Monitor Batch: Daily Top 20" author="Anand Mahajani" subject="XPLAN" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Agency FB" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\f1\fs20\i0\b0 Date: 3/13/2018 10:07:12 AM\fs24
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/13/2018 10:07:12 AM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LEGAL" orientation="0" measurement="in" margintop="0.0" marginbottom="0.0" marginleft="0.0" marginright="0.0" />
				</pdf>
		</display>
	</display>
	<display id="72d4cb77-0154-1000-8010-0a6e2108548f" type="" style="Table" enable="true">
		<name><![CDATA[03. Table Scans]]></name>
		<description><![CDATA[]]></description>
		<tooltip><![CDATA[]]></tooltip>
		<drillclass><![CDATA[]]></drillclass>
		<CustomValues>
			<TYPE><![CDATA[horizontal]]></TYPE>
		</CustomValues>
		<query>
			<sql><![CDATA[select distinct
  dhash.INSTANCE_NUMBER INST_ID
, dhash.SNAP_ID
, dhsp.SQL_ID
, dhsp.PLAN_HASH_VALUE
, dhash.SQL_OPNAME
, case 
    when instr(dhash.MODULE,'@',1,1) > 0 then substr(dhash.MODULE, 1, instr(dhash.MODULE,'@',1,1)-1) 
    when instr(dhash.MODULE,'.',-1,1) > 0 then substr(dhash.MODULE, 1, instr(dhash.MODULE,'.',-1,1)-1) 
  else
    dhash.MODULE
  end MODULE
, nvl(dhash.ACTION, 'N/A') ACTION
--, dhash.MODULE
--, dhash.ACTION
, dhash.CLIENT_ID
, OBJECT_OWNER
, OBJECT_NAME
, operation||' '||options operation
, TIMESTAMP
--, COST
, CASE
    WHEN COST >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000*1000*1000*1000),2),'FM999000.00') || ' Q'
    WHEN COST >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000*1000*1000),2),'FM999000.00') || ' T'
    WHEN COST >= (1000*1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000*1000),2),'FM999000.00') || ' B'
    WHEN COST >= (1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000),2),'FM999000.00') || ' M'
    WHEN COST >= 1000 THEN TO_CHAR(ROUND(COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(COST,'FM999000') || '  '
  END COST
, CASE
    WHEN CPU_COST >= 1000000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN CPU_COST >= 1000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000,2),'FM999000.00') || ' T'
    WHEN CPU_COST >= 1000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000,2),'FM999000.00') || ' B'
    WHEN CPU_COST >= 1000000 THEN TO_CHAR(ROUND(CPU_COST/1000000,2),'FM999000.00') || ' M' 
    WHEN CPU_COST >= 1000 THEN TO_CHAR(ROUND(CPU_COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM999000.00') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST >= 1000000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN IO_COST >= 1000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000,2),'FM999000.00') || ' T'
    WHEN IO_COST >= 1000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000,2),'FM999000.00') || ' B'
    WHEN IO_COST >= 1000000 THEN TO_CHAR(ROUND(IO_COST/1000000,2),'FM999000.00') || ' M' 
    WHEN IO_COST >= 1000 THEN TO_CHAR(ROUND(IO_COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(IO_COST,'FM999000.00') || '  '
  END AS IO_COST
, TEMP_SPACE
,  CASE
    WHEN CARDINALITY >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000*1000*1000*1000),2),'FM999000.00') || ' Q'
    WHEN CARDINALITY >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000*1000*1000),2),'FM999000.00') || ' T'
    WHEN CARDINALITY >= (1000*1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000*1000),2),'FM999000.00') || ' B'
    WHEN CARDINALITY >= (1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000),2),'FM999000.00') || ' M'
    WHEN CARDINALITY >= 1000 THEN TO_CHAR(ROUND(CARDINALITY/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(CARDINALITY,'FM999000') || '  '
  END CARDINALITY
, CASE
    WHEN BYTES >= (1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024),2),'FM999000.00') || ' TB'
    WHEN BYTES >= (1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024),2),'FM999000.00') || ' GB'
    WHEN BYTES >= (1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024),2),'FM999000.00') || ' MB'
    WHEN BYTES >= 1024 THEN TO_CHAR(ROUND(BYTES/1024,2),'FM999000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM999000.00') || '   '
  END BYTES
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM99900000') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')|| 's'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')|| 's'
  END TIME
, 'select * from table(dbms_xplan.display_awr('||''''||dhsp.SQL_ID||''''||'));' xplan
from
  DBA_HIST_SQL_PLAN dhsp
, DBA_HIST_ACTIVE_SESS_HISTORY dhash
where
  dhsp.SQL_ID             = dhash.SQL_ID        AND
  operation||' '||options = 'TABLE ACCESS FULL' AND
  dhash.MODULE            <> 'DBMS_SCHEDULER'   AND
  dhash.SESSION_TYPE      = 'FOREGROUND'        AND
  OBJECT_OWNER  not in (
                     'APEX_030200'
                   , 'APEX_PUBLIC_USER'
                   , 'APPQOSSYS'
                   , 'CTXSYS'
                   , 'DBSNMP'
                   , 'DIP'
                   , 'EXFSYS'
                   , 'FLOWS_FILES'
                   , 'HR'
                   , 'MDSYS'
                   , 'OE'
                   , 'OLAPSYS'
                   , 'ORACLE_OCM'
                   , 'ORDDATA'
                   , 'ORDPLUGINS'
                   , 'ORDSYS'
                   , 'OUTLN'
                   , 'OWBSYS_AUDIT'
                   , 'OWBSYS'
                   , 'SCOTT'
                   , 'SH'
                   , 'SI_INFORMTN_SCHEMA'
                   , 'SYS'
                 --, 'SYSMAN'
                 --, 'SYSTEM'
                   , 'WMSYS'
                   , 'XDB'
                   ) AND
  TIMESTAMP between trunc(sysdate -1) and trunc(sysdate)]]></sql>
		</query>
			<pdf version="VERSION_1_7" compression="CONTENT">
				<docproperty title="null" author="null" subject="null" keywords="null" />
				<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
				<column>
					<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
					<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
					<blob blob="NONE" zip="false" />
				</column>
				<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
				<header enable="false" generatedate="false">
					<data>
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					</data>
				</header>
				<footer enable="false" generatedate="false">
					<data value="null" />
				</footer>
				<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
			</pdf>
		<display id="" type="" style="Code" enable="true">
			<name><![CDATA[SQL Text]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[/*select 
 REPLACE(ST.SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID AND
  SS.SQL_ID          = :SQL_ID   AND
  SS.SNAP_ID         = :SNAP_ID  AND
  INSTANCE_NUMBER    = :INST_ID  AND
  SS.PLAN_HASH_VALUE = :PLAN_HASH_VALUE */
  
--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
--- Author: Anand Mahajani
--- Date: 2018/12/06 (of last update/validation)
select 
  REPLACE(SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID AND
  SS.SQL_ID          = :SQL_ID   AND
  SS.SNAP_ID         = :SNAP_ID]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Executions]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  SNAP_ID
, PLAN_HASH_VALUE
, EXECUTIONS_DELTA EXECUTIONS
, CASE 
    WHEN (ELAPSED_TIME_DELTA/1000000) is null then ' '
    WHEN (ELAPSED_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END ELAPSED_TIME
, TO_CHAR(round((ELAPSED_TIME_DELTA/1000)/nvl(replace(EXECUTIONS_DELTA,0,1),1)),'FM999,999,990') "ELAPSED/EXEC(ms)"
, FETCHES_DELTA FETCHES
, ROWS_PROCESSED_TOTAL ROWS_PROCESSED
, SORTS_DELTA SORTS
, DISK_READS_DELTA DISK_READS
, BUFFER_GETS_DELTA BUFFER_GETS
, CASE 
    WHEN (CPU_TIME_DELTA/1000000) is null then ' '
    WHEN (CPU_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END CPU_TIME
--, round(CPU_TIME_DELTA/1000000,2) CPU_TIME
, round(IOWAIT_DELTA/1000000,2) IOWAIT
, round(CLWAIT_DELTA/1000000,2) CLUSTER_WAIT
, round(CCWAIT_DELTA/1000000,2) CONCURRENCY_WAIT
, round(APWAIT_DELTA/1000000,2) APPLICATION_WAIT
, DIRECT_WRITES_DELTA DIRECT_WRITES
,   CASE
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024),2),'FM000.00') || ' MB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > 1024 THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(IO_INTERCONNECT_BYTES_DELTA,'FM9000.00') || '   '
  END IO_INTERCONNECT_BYTES
from DBA_HIST_SQLSTAT
where 
  SQL_ID = :SQL_ID
--INSTANCE_NUMBER = :INST_ID]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Explain Plan]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT 
  TIMESTAMP
, PLAN_HASH_VALUE
, LPAD('  ',2*(DEPTH-1))
  ||operation
  ||' '
  ||OPTIONS
  ||' '
  ||DECODE(id, 0, 'Cost = '
--||position
  ||
  CASE
    WHEN position >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000*1000),2),'FM999.00') || ' Q'
    WHEN position >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000),2),'FM999.00') || ' T'
    WHEN position >= (1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000),2),'FM999.00') || ' B'
    WHEN position >= (1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000),2),'FM999.00') || ' M'
    WHEN position >= 1000 THEN TO_CHAR(ROUND(position/1000,2),'FM999.00') || ' K'
    ELSE TO_CHAR(position,'FM9999') || '  '
  END
  ) "EXPLAIN PLAN"
, nvl(object_name,' ') object_name
, nvl(object_type,' ') object_type
, lpad(
  CASE
    WHEN cardinality >= 1000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000,2),'FM000.00') || ' T'
    WHEN cardinality >= 1000000000 THEN TO_CHAR(ROUND(cardinality/1000000000,2),'FM000.00') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(ROUND(cardinality/1000000,2),'FM000.00') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(ROUND(cardinality/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(cardinality,'FM000') || '     '
  END , 9 , ' ' ) AS "Rows"
, CASE
    WHEN BYTES > (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM000.00') || ' PB'
    WHEN BYTES > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN BYTES > (1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN BYTES > (1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024),2),'FM000.00') || ' MB'
    WHEN BYTES > 1024 THEN TO_CHAR(ROUND(BYTES/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM9000.00') || '   '
  END BYTES
, CASE
    WHEN TEMP_SPACE > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN TEMP_SPACE > (1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN TEMP_SPACE > (1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024),2),'FM000.00') || ' MB'
    WHEN TEMP_SPACE > 1024 THEN TO_CHAR(ROUND(TEMP_SPACE/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(TEMP_SPACE,'FM9000.00') || '   '
  END TEMP_SPACE
, CASE
    WHEN CPU_COST > 1000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000,2),'FM9000.00') || ' T'
    WHEN CPU_COST > 1000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000,2),'FM9000.00') || ' B'
    WHEN CPU_COST > 1000000 THEN TO_CHAR(ROUND(CPU_COST/1000000,2),'FM9000.00') || ' M' 
    WHEN CPU_COST > 1000 THEN TO_CHAR(ROUND(CPU_COST/1000,2),'FM9000.00') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM9000.00') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST > 1000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000,2),'FM9000.00') || ' B'
    WHEN IO_COST > 1000000 THEN TO_CHAR(ROUND(IO_COST/1000000,2),'FM9000.00') || ' M' 
    WHEN IO_COST > 1000 THEN TO_CHAR(ROUND(IO_COST/1000,2),'FM9000.00') || ' K'
    ELSE TO_CHAR(IO_COST,'FM9000.00') || '  '
  END AS IO_COST
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
  END TIME
, ACCESS_PREDICATES
, FILTER_PREDICATES
, PROJECTION
FROM 
  DBA_HIST_SQL_PLAN sp,
  ( SELECT
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
    , COUNT(*) entries
    FROM
      DBA_HIST_ACTIVE_SESS_HISTORY
    WHERE
      sql_id   = :SQL_ID AND
      ( sql_exec_id
      , SQL_PLAN_HASH_VALUE) IN
      ( SELECT
          sql_exec_id
        , SQL_PLAN_HASH_VALUE
        FROM
          DBA_HIST_ACTIVE_SESS_HISTORY
        WHERE
          sql_id = :SQL_ID AND
          rownum = 1
      )
    GROUP BY
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
  ) ash
WHERE
  sp.sql_id               = :SQL_ID   AND
  ash.sql_id(+)           = sp.sql_id AND
  ash.sql_plan_line_id(+) = sp.id
ORDER BY
  TIMESTAMP DESC
, sp.id]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Bind Variables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  INSTANCE_NUMBER
, snap_id
, sql_id
, datatype_string
, position
, value_string value
, to_char(last_captured,'YYYY-MM-DD HH:MI:SS AM') last_captured 
from DBA_HIST_SQLBIND
where 
  sql_id          = :SQL_ID    and
  INSTANCE_NUMBER = :INST_ID   and
  snap_id         = :SNAP_ID   and
  last_captured     is not null 
order by
  position
, last_captured]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Elapsed Time History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  day
, serial
, value
from
  ( select
      to_char(s.begin_interval_time,'mm/dd/yyyy hh24') day
    , 'Elapsed time(s)' serial
    , ROUND(AVG((SQL.ELAPSED_TIME_DELTA/1000000/nvl(replace(sql.executions_delta,0,1),1) )),2) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
    GROUP BY
      to_char(s.begin_interval_time,'mm/dd/yyyy hh24')
    , sql_id 
    union all
  ( select
      to_char(s.begin_interval_time,'mm/dd/yyyy hh24') day
    , 'Executions' serial
    , SUM(sql.executions_delta) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
   GROUP BY
     to_char(s.begin_interval_time,'mm/dd/yyyy hh24')
   , sql_id
  ) 
  )
order by
  day]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Tuning Advice]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[declare
  l_sql               VARCHAR2(500) := :SQL_ID;
  bsnap               number := :SNAP_ID;
  esnap               number := bsnap+1;
  tname               varchar2(400) := 'tuning_task_'||l_sql;
  descr               varchar2(400) := 'Tuning task for statement '||l_sql;
  l_sql_tune_task_id  varchar2(400);
  recommendations     varchar2(2000);
  RetVal              CLOB;
  MAXBUFSIZE          NUMBER := 32767;
BEGIN
  dbms_output.enable(1000000);
  l_sql_tune_task_id := dbms_sqltune.create_tuning_task ( BEGIN_SNAP=>bsnap, END_SNAP=>esnap, sql_id =>l_sql, PLAN_HASH_VALUE=>:PLAN_HASH_VALUE, time_limit =>600, task_name =>tname, description =>descr);
  begin
    DBMS_SQLTUNE.reset_tuning_task (task_name => tname);
    DBMS_SQLTUNE.execute_tuning_task(task_name => tname);
    RetVal := dbms_sqltune.report_tuning_task(l_sql_tune_task_id);
    dbms_output.put_line('<PRE>');
    dbms_output.put_line(dbms_lob.substr( RetVal, MAXBUFSIZE-1, 1 ));
    dbms_output.put_line('</PRE>');
    dbms_sqltune.DROP_TUNING_TASK(tname);
  exception 
    when others then
      dbms_output.put_line('Unable to produce report.');
      dbms_output.put_line(SQLERRM);
      dbms_sqltune.DROP_TUNING_TASK(tname);
  end; 
END;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Tables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[SELECT
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000.00') || '  '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000.00') || '  '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id                            = :SQL_ID AND
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE
  ) AND
  o.owner             = ts.owner           AND
  o.owner             = t.owner             AND
  o.object_name = ts.table_name AND
  ts.table_name  = t.table_name   AND
  o.object_type    = 'TABLE'              AND
  o.owner                not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PLAN_HASH_VALUE">
						<prompt><![CDATA[PLAN_HASH_VALUE]]></prompt>
						<tooltip><![CDATA[PLAN_HASH_VALUE]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Indexes]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/26 (of last update/validation)
--- Update: 2016/08/02
--- Using LISTAGG - anlytical function introduced in database 11gR2 inplace of SUBSTR(SYS_CONNECT_BY_PATH(column_name, ', '),2) for Index column_list
------------------------------------------------------------------------------------------------------------------------------------
select
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created segment
, UNIQUENESS
, tablespace_name
, visibility
, listagg(dic.column_name, ', ') within group(order by di.owner, di.table_name, di.index_name, dic.column_position) as column_list
, CASE
    WHEN distinct_keys >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN distinct_keys >= (1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN distinct_keys >= (1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000),2),'FM000.00') || ' M'
    WHEN distinct_keys >= 1000 THEN TO_CHAR(ROUND(distinct_keys/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(distinct_keys,'FM000.00') || '  '
  END distinct_keys
, CASE
    WHEN NUM_ROWS >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN NUM_ROWS >= (1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN NUM_ROWS >= (1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000),2),'FM000.00') || ' M'
    WHEN NUM_ROWS >= 1000 THEN TO_CHAR(ROUND(NUM_ROWS/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(NUM_ROWS,'FM000.00') || '  '
  END NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') created
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') LAST_DDL_TIME
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') last_analyzed
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' LOGGING;'
    ELSE NULL
  END  "ALTER INDEX"
from
    dba_ind_columns dic
  , dba_indexes di
  , dba_ind_expressions die
  , dba_objects do
  WHERE 
  --(dic.table_name       like trim(upper(:TABLE_NAME)) or instr(dic.TABLE_NAME, trim(upper(:TABLE_NAME))) > 0) AND -- do not delete this line even if it is commented
  --dic.table_name      = trim(upper(:TABLE_NAME)) AND
    do.object_type      = 'INDEX'                AND
    dic.index_name      = di.index_name          AND
    dic.index_name      = die.index_name(+)      AND
    dic.COLUMN_POSITION = die.COLUMN_POSITION(+) AND
    dic.index_owner     = do.owner               AND
    dic.index_name      = do.object_name         AND
    do.object_name        IN
    ( SELECT
        o.object_name
      FROM
        dba_objects o
      WHERE
      ( o.object_name) IN
      ( SELECT
          sp.object_name
        FROM
          DBA_HIST_SQL_PLAN sp
        WHERE
          sql_id          = :SQL_ID          AND
          PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
          sp.operation      like '%INDEX%'   AND
          sp.object_type    IS NOT NULL
      ) 
    )
group by
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created
, UNIQUENESS
, tablespace_name
, visibility
, distinct_keys
, NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
order by
  di.table_name
, di.index_name]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PLAN_HASH_VALUE">
						<prompt><![CDATA[PLAN_HASH_VALUE]]></prompt>
						<tooltip><![CDATA[PLAN_HASH_VALUE]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Views]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, v.text
from
  dba_objects o
, dba_views v
where
  ( o.object_id
  , o.object_name) in
  ( select
      sp.OBJECT#
    , sp.object_name
    from
      DBA_HIST_SQL_PLAN sp
    where 
      sql_id = :SQL_ID
  ) and
  o.owner       = v.owner     and
  o.object_name = v.view_name and
  o.object_type = 'VIEW'      and
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Stats History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[WITH TABLE_LIST AS
(SELECT
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000.00') || '  '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000.00') || '  '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id          = :SQL_ID and
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE
  ) AND
  o.owner       = ts.owner AND
  o.owner       = t.owner AND
  o.object_name = ts.table_name AND
  ts.table_name = t.table_name AND
  o.object_type = 'TABLE' AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
--order by
--o.object_name
  )
-------------------------------------------------------------------------------------------------------------------------------------------
/*
Created: Anand Mahajani, 2018/03/13
*/
select
  OWNER
, TABLE_NAME
, STATS_UPDATE_TIME
, PARTITION_NAME
, SUBPARTITION_NAME
, 'EXECUTE DBMS_STATS.RESTORE_TABLE_STATS(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',AS_OF_TIMESTAMP=>'||''''||STATS_UPDATE_TIME||''''||');' "RESTORE TABLE STATS"
, 'SELECT * FROM TABLE(DBMS_STATS.DIFF_TABLE_STATS_IN_HISTORY(OWNNAME=>'||''''||OWNER||''''||',TABNAME=>'||''''||TABLE_NAME||''''||',TIME1=>'||''''||STATS_UPDATE_TIME||''''||',TIME2=>'||''''||LAG(STATS_UPDATE_TIME, 1) OVER (ORDER BY TABLE_NAME)||''''||',pctthreshold =>10));' "STATS DIFF"
from
  DBA_TAB_STATS_HISTORY
where
  table_name in (select table_name from TABLE_LIST)
order by
  TABLE_NAME
, STATS_UPDATE_TIME DESC]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[ASH SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[declare
  BIT      date;
  EIT      date;
  dbid     number;
  start_id number;
  end_id   number;
  inst_id  number;
begin
  select distinct dbid into dbid from v$database;
  start_id := to_number(:SNAP_ID-1);
  end_id   := to_number(start_id+4);
  inst_id  := :INST_ID;
  select BEGIN_INTERVAL_TIME into BIT from DBA_HIST_SNAPSHOT where SNAP_ID = start_id and INSTANCE_NUMBER = inst_id;
  select END_INTERVAL_TIME into EIT from DBA_HIST_SNAPSHOT where SNAP_ID = end_id and INSTANCE_NUMBER = inst_id;
  dbms_output.enable(500000);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.ash_report_text( dbid,inst_id,BIT, EIT, L_SQL_ID=>:SQL_ID))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>') ;
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[AWR SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select output from table(dbms_workload_repository.AWR_SQL_REPORT_TEXT( (select dbid from v$database),
                                                            :INST_ID,
                                                            :SNAP_ID-3, :SNAP_ID+1,
                                                            :SQL_ID ))]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[AWR]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[declare
  dbid     number;
  start_id number;
  end_id   number;
begin
  dbms_output.enable(1000000);
  select distinct dbid into dbid from gv$database;
  start_id := to_number(:SNAP_ID-3);
  end_id   := to_number(start_id+4);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.awr_report_text(dbid,:INST_ID,start_id,end_id))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>');
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[XPLAN]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select * from table(dbms_xplan.display_awr(:SQL_ID))]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
	</display>
	<display id="7318617d-0154-1000-8002-0a6e210843b7" type="" style="Table" enable="true">
		<name><![CDATA[04. Cartesian Joins]]></name>
		<description><![CDATA[]]></description>
		<tooltip><![CDATA[]]></tooltip>
		<drillclass><![CDATA[]]></drillclass>
		<CustomValues>
			<TYPE><![CDATA[horizontal]]></TYPE>
		</CustomValues>
		<query>
			<sql><![CDATA[select distinct
  dhash.INSTANCE_NUMBER INST_ID
, dhash.SNAP_ID
, dhsp.SQL_ID
, dhsp.PLAN_HASH_VALUE
, dhash.SQL_OPNAME
, case 
    when instr(dhash.MODULE,'@',1,1) > 0 then substr(dhash.MODULE, 1, instr(dhash.MODULE,'@',1,1)-1) 
    when instr(dhash.MODULE,'.',-1,1) > 0 then substr(dhash.MODULE, 1, instr(dhash.MODULE,'.',-1,1)-1) 
  else
    dhash.MODULE
  end MODULE
, nvl(dhash.ACTION, 'N/A') ACTION
--, dhash.MODULE
--, dhash.ACTION
, dhash.CLIENT_ID
--, dhsp.OBJECT_OWNER -- returns null 
--, OBJECT_NAME
, operation||' '||options operation
, TIMESTAMP
--, COST
, CASE
    WHEN COST >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000*1000*1000*1000),2),'FM999000.00') || ' Q'
    WHEN COST >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000*1000*1000),2),'FM999000.00') || ' T'
    WHEN COST >= (1000*1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000*1000),2),'FM999000.00') || ' B'
    WHEN COST >= (1000*1000) THEN TO_CHAR(ROUND(COST/(1000*1000),2),'FM999000.00') || ' M'
    WHEN COST >= 1000 THEN TO_CHAR(ROUND(COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(COST,'FM999000') || '  '
  END COST
, CASE
    WHEN CPU_COST >= 1000000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN CPU_COST >= 1000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000,2),'FM999000.00') || ' T'
    WHEN CPU_COST >= 1000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000,2),'FM999000.00') || ' B'
    WHEN CPU_COST >= 1000000 THEN TO_CHAR(ROUND(CPU_COST/1000000,2),'FM999000.00') || ' M' 
    WHEN CPU_COST >= 1000 THEN TO_CHAR(ROUND(CPU_COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM999000.00') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST >= 1000000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN IO_COST >= 1000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000,2),'FM999000.00') || ' T'
    WHEN IO_COST >= 1000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000,2),'FM999000.00') || ' B'
    WHEN IO_COST >= 1000000 THEN TO_CHAR(ROUND(IO_COST/1000000,2),'FM999000.00') || ' M' 
    WHEN IO_COST >= 1000 THEN TO_CHAR(ROUND(IO_COST/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(IO_COST,'FM999000.00') || '  '
  END AS IO_COST
, TEMP_SPACE
,  CASE
    WHEN CARDINALITY >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000*1000*1000*1000),2),'FM999000.00') || ' Q'
    WHEN CARDINALITY >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000*1000*1000),2),'FM999000.00') || ' T'
    WHEN CARDINALITY >= (1000*1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000*1000),2),'FM999000.00') || ' B'
    WHEN CARDINALITY >= (1000*1000) THEN TO_CHAR(ROUND(CARDINALITY/(1000*1000),2),'FM999000.00') || ' M'
    WHEN CARDINALITY >= 1000 THEN TO_CHAR(ROUND(CARDINALITY/1000,2),'FM999000.00') || ' K'
    ELSE TO_CHAR(CARDINALITY,'FM999000') || '  '
  END CARDINALITY
--, CARDINALITY
, CASE
    WHEN BYTES >= (1024*1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024*1024),2),'FM999000.00') || ' EB'
    WHEN BYTES >= (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM999000.00') || ' PB'
    WHEN BYTES >= (1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024),2),'FM999000.00') || ' TB'
    WHEN BYTES >= (1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024),2),'FM999000.00') || ' GB'
    WHEN BYTES >= (1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024),2),'FM999000.00') || ' MB'
    WHEN BYTES >= 1024 THEN TO_CHAR(ROUND(BYTES/1024,2),'FM999000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM999000.00') || '   '
  END BYTES
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM9999999900') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')|| 's'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00')|| 's'
  END TIME
, 'select * from table(dbms_xplan.display_awr('||''''||dhsp.SQL_ID||''''||'));' xplan
from
  DBA_HIST_SQL_PLAN dhsp
, DBA_HIST_ACTIVE_SESS_HISTORY dhash
where
  dhsp.SQL_ID             = dhash.SQL_ID           AND
  operation||' '||options = 'MERGE JOIN CARTESIAN' AND
  dhash.MODULE            <> 'DBMS_SCHEDULER'      AND
  dhash.SESSION_TYPE      = 'FOREGROUND'           AND
  TIMESTAMP between trunc(sysdate - 1) and trunc(sysdate)
order by
  dhash.INSTANCE_NUMBER
, dhash.SNAP_ID]]></sql>
		</query>
			<pdf version="VERSION_1_7" compression="CONTENT">
				<docproperty title="null" author="null" subject="null" keywords="null" />
				<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
				<column>
					<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
					<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
					<blob blob="NONE" zip="false" />
				</column>
				<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
				<header enable="false" generatedate="false">
					<data>
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
				</header>
				<footer enable="false" generatedate="false">
					<data value="null" />
				</footer>
				<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
			</pdf>
		<display id="" type="" style="Code" enable="true">
			<name><![CDATA[SQL Text]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[/*select 
 REPLACE(ST.SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID AND
  SS.SQL_ID          = :SQL_ID   AND
  SS.SNAP_ID         = :SNAP_ID  AND
  INSTANCE_NUMBER    = :INST_ID */
  
--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
--- Author: Anand Mahajani
--- Date: 2018/12/06 (of last update/validation)
select 
  REPLACE(SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID AND
  SS.SQL_ID          = :SQL_ID   AND
  SS.SNAP_ID         = :SNAP_ID  AND
  INSTANCE_NUMBER    = :INST_ID]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Executions]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--select * from table(dbms_xplan.display_awr(:SQL_ID))

select
  SNAP_ID
, PLAN_HASH_VALUE
, EXECUTIONS_DELTA EXECUTIONS
, CASE 
    WHEN (ELAPSED_TIME_DELTA/1000000) is null then ' '
    WHEN (ELAPSED_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END ELAPSED_TIME
, TO_CHAR(round((ELAPSED_TIME_DELTA/1000)/nvl(replace(EXECUTIONS_DELTA,0,1),1)),'FM999,999,990') "ELAPSED/EXEC(ms)"
, FETCHES_DELTA FETCHES
, ROWS_PROCESSED_TOTAL ROWS_PROCESSED
, SORTS_DELTA SORTS
, DISK_READS_DELTA DISK_READS
, BUFFER_GETS_DELTA BUFFER_GETS
, CASE 
    WHEN (CPU_TIME_DELTA/1000000) is null then ' '
    WHEN (CPU_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END CPU_TIME
--, round(CPU_TIME_DELTA/1000000,2) CPU_TIME
, round(IOWAIT_DELTA/1000000,2) IOWAIT
, round(CLWAIT_DELTA/1000000,2) CLUSTER_WAIT
, round(CCWAIT_DELTA/1000000,2) CONCURRENCY_WAIT
, round(APWAIT_DELTA/1000000,2) APPLICATION_WAIT
, DIRECT_WRITES_DELTA DIRECT_WRITES
,   CASE
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024*1024),2),'FM9000.00') || ' TB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024),2),'FM9000.00') || ' GB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024),2),'FM9000.00') || ' MB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > 1024 THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(IO_INTERCONNECT_BYTES_DELTA,'FM9000.00') || '   '
  END IO_INTERCONNECT_BYTES
from DBA_HIST_SQLSTAT
where 
  SQL_ID          = :SQL_ID
--INSTANCE_NUMBER = :INST_ID]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Explain Plan]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT 
  TIMESTAMP
, PLAN_HASH_VALUE
, LPAD('  ',2*(DEPTH-1))
  ||operation
  ||' '
  ||OPTIONS
  ||' '
  ||DECODE(id, 0, 'Cost = '
--||position
  ||
  CASE
    WHEN position >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000*1000),2),'FM999.00') || ' Q'
    WHEN position >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000),2),'FM999.00') || ' T'
    WHEN position >= (1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000),2),'FM999.00') || ' B'
    WHEN position >= (1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000),2),'FM999.00') || ' M'
    WHEN position >= 1000 THEN TO_CHAR(ROUND(position/1000,2),'FM999.00') || ' K'
    ELSE TO_CHAR(position,'FM9999') || '  '
  END
  ) "EXPLAIN PLAN"
, nvl(object_name,' ') object_name
, nvl(object_type,' ') object_type
, lpad(
  CASE
    WHEN cardinality >= 1000000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000000,2),'FM99000.00') || ' Q'
    WHEN cardinality >= 1000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000,2),'FM9000.00') || ' T'
    WHEN cardinality >= 1000000000 THEN TO_CHAR(ROUND(cardinality/1000000000,2),'FM9000.00') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(ROUND(cardinality/1000000,2),'FM9000.00') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(ROUND(cardinality/1000,2),'FM9000.00') || ' K'
    ELSE TO_CHAR(cardinality,'FM9000') || '     '
  END , 9 , ' ' ) AS "Rows"
, CASE
    WHEN BYTES > (1024*1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024*1024),2),'FM9000.00') || ' EB'
    WHEN BYTES > (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM9000.00') || ' PB'
    WHEN BYTES > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024),2),'FM9000.00') || ' TB'
    WHEN BYTES > (1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024),2),'FM9000.00') || ' GB'
    WHEN BYTES > (1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024),2),'FM9000.00') || ' MB'
    WHEN BYTES > 1024 THEN TO_CHAR(ROUND(BYTES/1024,2),'FM9000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM9000.00') || '   '
  END BYTES
, CASE
    WHEN TEMP_SPACE > (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024*1024),2),'FM000.00') || ' PB'
    WHEN TEMP_SPACE > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN TEMP_SPACE > (1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN TEMP_SPACE > (1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024),2),'FM000.00') || ' MB'
    WHEN TEMP_SPACE > 1024 THEN TO_CHAR(ROUND(TEMP_SPACE/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(TEMP_SPACE,'FM9000.00') || '   '
  END TEMP_SPACE
, CASE
    WHEN CPU_COST > 1000000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN CPU_COST > 1000000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000000,2),'FM9000.00') || ' T'
    WHEN CPU_COST > 1000000000 THEN TO_CHAR(ROUND(CPU_COST/1000000000,2),'FM9000.00') || ' B'
    WHEN CPU_COST > 1000000 THEN TO_CHAR(ROUND(CPU_COST/1000000,2),'FM9000.00') || ' M' 
    WHEN CPU_COST > 1000 THEN TO_CHAR(ROUND(CPU_COST/1000,2),'FM9000.00') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM9000.00') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST > 1000000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000000,2),'FM999000.00') || ' Q'
    WHEN IO_COST > 1000000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000000,2),'FM9000.00') || ' T'
    WHEN IO_COST > 1000000000 THEN TO_CHAR(ROUND(IO_COST/1000000000,2),'FM9000.00') || ' B'
    WHEN IO_COST > 1000000 THEN TO_CHAR(ROUND(IO_COST/1000000,2),'FM9000.00') || ' M' 
    WHEN IO_COST > 1000 THEN TO_CHAR(ROUND(IO_COST/1000,2),'FM9000.00') || ' K'
    ELSE TO_CHAR(IO_COST,'FM9000.00') || '  '
  END AS IO_COST
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM9999990') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
  END TIME
, ACCESS_PREDICATES
, FILTER_PREDICATES
, PROJECTION
FROM 
  DBA_HIST_SQL_PLAN sp,
  ( SELECT
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
    , COUNT(*) entries
    FROM
      DBA_HIST_ACTIVE_SESS_HISTORY
    WHERE
      sql_id   = :SQL_ID AND
      ( sql_exec_id
      , SQL_PLAN_HASH_VALUE) IN
      ( SELECT
          sql_exec_id
        , SQL_PLAN_HASH_VALUE
        FROM
          DBA_HIST_ACTIVE_SESS_HISTORY
        WHERE
          sql_id = :SQL_ID AND
          SQL_PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
          rownum = 1
      )
    GROUP BY
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
  ) ash
WHERE
  sp.sql_id               = :SQL_ID   AND
  ash.sql_id(+)           = sp.sql_id AND
  ash.sql_plan_line_id(+) = sp.id
ORDER BY
  TIMESTAMP desc
, sp.id]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PLAN_HASH_VALUE">
						<prompt><![CDATA[PLAN_HASH_VALUE]]></prompt>
						<tooltip><![CDATA[PLAN_HASH_VALUE]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Bind Variables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  INSTANCE_NUMBER
, snap_id
, sql_id
, datatype_string
, position
, value_string value
, to_char(last_captured,'YYYY-MM-DD HH24:MI:SS') last_captured 
from DBA_HIST_SQLBIND
where 
  sql_id          = :SQL_ID  and
  INSTANCE_NUMBER = :INST_ID and
  snap_id         = :SNAP_ID and
  last_captured     is not null 
order by
  position
, last_captured]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Chart" enable="true">
			<name><![CDATA[Elapsed Time History]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[BAR_VERT_CLUST]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  day
, serial
, value
from
  ( select
      to_char(s.begin_interval_time,'mm/dd/yyyy hh24') day
    , 'Elapsed time(s)' serial
    , ROUND(AVG((SQL.ELAPSED_TIME_DELTA/1000000/nvl(replace(sql.executions_delta,0,1),1) )),2) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
    GROUP BY
      to_char(s.begin_interval_time,'mm/dd/yyyy hh24')
    , sql_id 
    union all
  ( select
      to_char(s.begin_interval_time,'mm/dd/yyyy hh24') day
    , 'Executions' serial
    , SUM(sql.executions_delta) value
    from
      dba_hist_sqlstat sql
    , dba_hist_snapshot s
    where
      s.snap_id  = sql.snap_id AND
      SQL.sql_id = :SQL_ID
   GROUP BY
     to_char(s.begin_interval_time,'mm/dd/yyyy hh24')
   , sql_id
  ) 
  )
order by
  day]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Tuning Advice]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[declare
  l_sql               VARCHAR2(500) := :SQL_ID;
  bsnap               number := :SNAP_ID;
  esnap               number := bsnap+1;
  tname               varchar2(400) := 'tuning_task_'||l_sql;
  descr               varchar2(400) := 'Tuning task for statement '||l_sql;
  l_sql_tune_task_id  varchar2(400);
  recommendations     varchar2(2000);
  RetVal              CLOB;
  MAXBUFSIZE          NUMBER := 32767;
BEGIN
  dbms_output.enable(1000000);
  l_sql_tune_task_id := dbms_sqltune.create_tuning_task ( BEGIN_SNAP=>bsnap, END_SNAP=>esnap, sql_id =>l_sql, PLAN_HASH_VALUE=>:PLAN_HASH_VALUE, time_limit =>600, task_name =>tname, description =>descr);
  begin
    DBMS_SQLTUNE.reset_tuning_task (task_name => tname);
    DBMS_SQLTUNE.execute_tuning_task(task_name => tname);
    RetVal := dbms_sqltune.report_tuning_task(l_sql_tune_task_id);
    dbms_output.put_line('<PRE>');
    dbms_output.put_line(dbms_lob.substr( RetVal, MAXBUFSIZE-1, 1 ));
    dbms_output.put_line('</PRE>');
    dbms_sqltune.DROP_TUNING_TASK(tname);
  exception 
    when others then
      dbms_output.put_line('Unable to produce report.');
      dbms_output.put_line(SQLERRM);
      dbms_sqltune.DROP_TUNING_TASK(tname);
  end; 
END;]]></sql>
				<binds>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="PLAN_HASH_VALUE">
						<prompt><![CDATA[PLAN_HASH_VALUE]]></prompt>
						<tooltip><![CDATA[PLAN_HASH_VALUE]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Tables]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[SELECT
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, ts.last_analyzed
, CASE
    WHEN ts.num_rows > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.num_rows > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.num_rows > (1000*1000) THEN TO_CHAR(ROUND(ts.num_rows/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.num_rows > 1000 THEN TO_CHAR(ROUND(ts.num_rows/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.num_rows,'FM000.00') || '  '
  END num_rows
, CASE
    WHEN ts.sample_size > (1000*1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN ts.sample_size > (1000*1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN ts.sample_size > (1000*1000) THEN TO_CHAR(ROUND(ts.sample_size/(1000*1000),2),'FM000.00') || ' M'
    WHEN ts.sample_size > 1000 THEN TO_CHAR(ROUND(ts.sample_size/1024,2),'FM000.00') || ' K'
    ELSE TO_CHAR(ts.sample_size,'FM000.00') || '  '
  END sample_size
, ts.STATTYPE_LOCKED
, ts.STALE_STATS
, t.DEGREE
, t.INSTANCES
, t.PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER TABLE '||t.owner||'.'||t.TABLE_NAME||' LOGGING;'
    ELSE NULL
  END  "ALTER TABLE"
FROM
  dba_objects o
, dba_tab_statistics ts
, dba_tables t
WHERE
  ( o.object_id
  , o.object_name) IN
  ( SELECT
      sp.OBJECT#
    , sp.object_name
    FROM
      DBA_HIST_SQL_PLAN sp
    WHERE
      sql_id          = :SQL_ID and
      PLAN_HASH_VALUE = :PLAN_HASH_VALUE
  ) AND
  o.owner       = ts.owner      AND
  o.owner       = t.owner       AND
  o.object_name = ts.table_name AND
  ts.table_name = t.table_name  AND
  o.object_type = 'TABLE'       AND
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Indexes]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/26 (of last update/validation)
--- Update: 2016/08/02
--- Using LISTAGG - anlytical function introduced in database 11gR2 inplace of SUBSTR(SYS_CONNECT_BY_PATH(column_name, ', '),2) for Index column_list
------------------------------------------------------------------------------------------------------------------------------------
select
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created segment
, UNIQUENESS
, tablespace_name
, visibility
, listagg(dic.column_name, ', ') within group(order by di.owner, di.table_name, di.index_name, dic.column_position) as column_list
, CASE
    WHEN distinct_keys >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN distinct_keys >= (1000*1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN distinct_keys >= (1000*1000) THEN TO_CHAR(ROUND(distinct_keys/(1000*1000),2),'FM000.00') || ' M'
    WHEN distinct_keys >= 1000 THEN TO_CHAR(ROUND(distinct_keys/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(distinct_keys,'FM000.00') || '  '
  END distinct_keys
, CASE
    WHEN NUM_ROWS >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000*1000),2),'FM000.00') || ' T'
    WHEN NUM_ROWS >= (1000*1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000*1000),2),'FM000.00') || ' B'
    WHEN NUM_ROWS >= (1000*1000) THEN TO_CHAR(ROUND(NUM_ROWS/(1000*1000),2),'FM000.00') || ' M'
    WHEN NUM_ROWS >= 1000 THEN TO_CHAR(ROUND(NUM_ROWS/1000,2),'FM000.00') || ' K'
  ELSE TO_CHAR(NUM_ROWS,'FM000.00') || '  '
  END NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') created
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') LAST_DDL_TIME
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') last_analyzed
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
, CASE
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' AND LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL LOGGING;'
    WHEN trim(DEGREE) <> '1' or trim(INSTANCES) <> '1' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' NOPARALLEL;'
    WHEN LOGGING = 'NO' THEN
      'ALTER INDEX '||di.owner||'.'||di.index_name||' LOGGING;'
    ELSE NULL
  END  "ALTER INDEX"
from
  dba_ind_columns dic
, dba_indexes di
, dba_ind_expressions die
, dba_objects do
WHERE 
  --(dic.table_name       like trim(upper(:TABLE_NAME)) or instr(dic.TABLE_NAME, trim(upper(:TABLE_NAME))) > 0) AND -- do not delete this line even if it is commented
  --dic.table_name      = trim(upper(:TABLE_NAME)) AND
  do.object_type      = 'INDEX'                  AND
  dic.index_name      = di.index_name            AND
  dic.index_name      = die.index_name(+)        AND
  dic.COLUMN_POSITION = die.COLUMN_POSITION(+)   AND
  dic.index_owner     = do.owner                 AND
  dic.index_name      = do.object_name           AND
  do.object_name        IN
  ( SELECT
      o.object_name
    FROM
      dba_objects o
    WHERE
    ( o.object_name) IN
    ( SELECT
        sp.object_name
      FROM
        DBA_HIST_SQL_PLAN sp
      WHERE
        sql_id          = :SQL_ID          AND
        PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
        sp.operation      like '%INDEX%'   AND
        sp.object_type    IS NOT NULL
    ) 
  )
group by
  di.owner
, di.table_name
, di.index_name
, di.status
, logging
, segment_created
, UNIQUENESS
, tablespace_name
, visibility
, distinct_keys
, NUM_ROWS
, to_char(created, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(LAST_DDL_TIME, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, to_char(last_analyzed, 'DY DD-MON-YYYY HH24:MI:SS AM') 
, INDEX_TYPE
, FUNCIDX_STATUS
, CLUSTERING_FACTOR
, DEGREE
, INSTANCES
, PARTITIONED
order by
  di.table_name
, di.index_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Views]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select
  o.object_name
, o.object_type
, o.status
, o.CREATED
, o.LAST_DDL_TIME
, v.text
from
  dba_objects o
, dba_views v
where
  ( o.object_id
  , o.object_name) in
  ( select
      sp.OBJECT#
    , sp.object_name
    from
      DBA_HIST_SQL_PLAN sp
    where 
      sql_id = :SQL_ID
  ) and
  o.owner       = v.owner and
  o.object_name = v.view_name and
  o.object_type = 'VIEW' and
  o.owner         not in (
                         'APEX_030200'
                       , 'APEX_PUBLIC_USER'
                       , 'APPQOSSYS'
                       , 'CTXSYS'
                       , 'DBSNMP'
                       , 'DIP'
                       , 'EXFSYS'
                       , 'FLOWS_FILES'
                       , 'HR'
                       , 'MDSYS'
                       , 'OE'
                       , 'OLAPSYS'
                       , 'ORACLE_OCM'
                       , 'ORDDATA'
                       , 'ORDPLUGINS'
                       , 'ORDSYS'
                       , 'OUTLN'
                       , 'OWBSYS_AUDIT'
                       , 'OWBSYS'
                       , 'SCOTT'
                       , 'SH'
                       , 'SI_INFORMTN_SCHEMA'
                       , 'SYS'
                       , 'SYSMAN'
                       , 'SYSTEM'
                       , 'WMSYS'
                       , 'XDB'
                       )
order by
  o.object_name]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[Stats]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[ASH SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[declare
  BIT      date;
  EIT      date;
  dbid     number;
  start_id number;
  end_id   number;
  inst_id  number;
begin
  select distinct dbid into dbid from v$database;
  start_id := to_number(:SNAP_ID-1);
  end_id   := to_number(start_id+4);
  inst_id  := :INST_ID;
  select BEGIN_INTERVAL_TIME into BIT from DBA_HIST_SNAPSHOT where SNAP_ID = start_id and INSTANCE_NUMBER = inst_id;
  select END_INTERVAL_TIME into EIT from DBA_HIST_SNAPSHOT where SNAP_ID = end_id and INSTANCE_NUMBER = inst_id;
  dbms_output.enable(500000);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.ash_report_text( dbid,inst_id,BIT, EIT, L_SQL_ID=>:SQL_ID))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>') ;
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[AWR SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select output from table(dbms_workload_repository.AWR_SQL_REPORT_TEXT( (select dbid from v$database),
                                                            :INST_ID,
                                                            :SNAP_ID-3, :SNAP_ID+1,
                                                            :SQL_ID ))]]></sql>
				<binds>
					<bind id="INST_ID">
						<prompt><![CDATA[INST_ID]]></prompt>
						<tooltip><![CDATA[INST_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SNAP_ID">
						<prompt><![CDATA[SNAP_ID]]></prompt>
						<tooltip><![CDATA[SNAP_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
					<bind id="SQL_ID">
						<prompt><![CDATA[SQL_ID]]></prompt>
						<tooltip><![CDATA[SQL_ID]]></tooltip>
						<value><![CDATA[NULL_VALUE]]></value>
						<bracket><![CDATA[null]]></bracket>
					</bind>
				</binds>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[AWR]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[declare
  dbid     number;
  start_id number;
  end_id   number;
begin
  dbms_output.enable(1000000);
  select distinct dbid into dbid from gv$database;
  start_id := to_number(:SNAP_ID-3);
  end_id   := to_number(start_id+4);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.awr_report_text(dbid,:INST_ID,start_id,end_id))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>');
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="" type="" style="Table" enable="true">
			<name><![CDATA[XPLAN]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select * from table(dbms_xplan.display_awr(:SQL_ID))]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="null" author="null" subject="null" keywords="null" />
					<cell toppadding="2" bottompadding="2" leftpadding="2" rightpadding="2" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="FIRST_PAGE" />
						<footing font="null" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="null" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="12" spacingafter="12" horizontalalign="LEFT" />
					<header enable="false" generatedate="false">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						null																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												</data>
					</header>
					<footer enable="false" generatedate="false">
						<data value="null" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
	</display>
	<display id="381b7128-0164-1000-8001-c0a8bf01ef12" type="" style="Table" enable="true">
		<name><![CDATA[05. Session]]></name>
		<description><![CDATA[]]></description>
		<tooltip><![CDATA[]]></tooltip>
		<drillclass><![CDATA[]]></drillclass>
		<CustomValues>
			<TYPE><![CDATA[horizontal]]></TYPE>
		</CustomValues>
		<query>
			<sql><![CDATA[select distinct
  SNAP_ID
, INSTANCE_NUMBER INST_ID
, SESSION_ID
, SESSION_SERIAL#
, SQL_ID
, SQL_CHILD_NUMBER CHILD#
, SQL_PLAN_HASH_VALUE PLAN_HASH_VALUE
, SQL_FULL_PLAN_HASH_VALUE SPHV
--, SQL_OPCODE
, SQL_OPNAME
, case
    when instr(PROGRAM,'@',1,1) > 0 then substr(PROGRAM, 1, instr(PROGRAM,'@',1,1)-1) 
    when instr(PROGRAM,'.',-1,1) > 0 then substr(PROGRAM, 1, instr(PROGRAM,'.',-1,1)-1)
  else PROGRAM
  end PROGRAM
, case 
    when instr(MODULE,'@',1,1) > 0 then substr(MODULE, 1, instr(MODULE,'@',1,1)-1) 
    when instr(MODULE,'.',-1,1) > 0 then substr(MODULE, 1, instr(MODULE,'.',-1,1)-1) 
    when instr(MODULE,'\',-1,1) > 0 then substr(MODULE, instr(MODULE,'\',-1,1)+1)
  else
    MODULE
  end module
, nvl(ACTION, 'N/A') action
--, MODULE
--, ACTION
, CLIENT_ID
, CASE
    when instr(MACHINE,'\',-1,1) > 0 then substr(MACHINE, instr(MACHINE,'\',-1,1)+1)
    when instr(machine, '.') > 0 then substr(machine, 1, instr(machine, '.')-1)
  else MACHINE
  end MACHINE
, to_char(SAMPLE_TIME, 'YYYY-MM-DD HH24:MI:SS.FF') SAMPLE_TIME
, SESSION_TYPE
, CASE 
    WHEN (TM_DELTA_TIME/1000000) is null then ' '
    WHEN (TM_DELTA_TIME/1000000) >= 3600*24 then
      TO_CHAR(TRUNC((TM_DELTA_TIME/1000000)/3600/24),'FM90') || 'd ' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_TIME/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((TM_DELTA_TIME/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((TM_DELTA_TIME/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((TM_DELTA_TIME/1000000),60),'FM00.00')||'s'
  END TM_DELTA_TIME 
--, TM_DELTA_TIME/1000000 TM_DELTA_TIME
, CASE 
    WHEN (TM_DELTA_CPU_TIME/1000000) is null then ' '
    WHEN (TM_DELTA_CPU_TIME/1000000) >= 3600*24 then
      TO_CHAR(TRUNC((TM_DELTA_CPU_TIME/1000000)/3600/24),'FM90') || 'd ' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_CPU_TIME/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_CPU_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((TM_DELTA_CPU_TIME/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((TM_DELTA_CPU_TIME/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_CPU_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((TM_DELTA_CPU_TIME/1000000),60),'FM00.00')||'s'
  END TM_DELTA_CPU_TIME
--, TM_DELTA_CPU_TIME/1000000 TM_DELTA_CPU_TIME
, CASE 
    WHEN (TM_DELTA_DB_TIME/1000000) is null then ' '
    WHEN (TM_DELTA_DB_TIME/1000000) >= 3600*24 then
      TO_CHAR(TRUNC((TM_DELTA_DB_TIME/1000000)/3600/24),'FM90') || 'd ' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_DB_TIME/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_DB_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((TM_DELTA_DB_TIME/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((TM_DELTA_DB_TIME/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((TM_DELTA_DB_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((TM_DELTA_DB_TIME/1000000),60),'FM00.00')||'s'
  END TM_DELTA_DB_TIME
--, TM_DELTA_DB_TIME/1000000 TM_DELTA_DB_TIME
, CASE 
    WHEN (DELTA_TIME/1000000) is null then ' '
    WHEN (DELTA_TIME/1000000) >= 3600*24 then
      TO_CHAR(TRUNC((DELTA_TIME/1000000)/3600/24),'FM90') || 'd ' ||
      TO_CHAR(TRUNC(MOD((DELTA_TIME/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((DELTA_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((DELTA_TIME/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((DELTA_TIME/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((DELTA_TIME/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((DELTA_TIME/1000000),60),'FM00.00')||'s'
  END DELTA_TIME
--, DELTA_TIME/1000000 DELTA_TIME
, DELTA_READ_IO_REQUESTS
, DELTA_WRITE_IO_REQUESTS
, DELTA_READ_IO_BYTES
, DELTA_WRITE_IO_BYTES
, DELTA_INTERCONNECT_IO_BYTES
, round((PGA_ALLOCATED/1024/1024), 2) PGA_MB
, TEMP_SPACE_ALLOCATED
, DBOP_NAME
, DBOP_EXEC_ID
, FLAGS
, USER_ID
, FORCE_MATCHING_SIGNATURE
, SQL_ADAPTIVE_PLAN_RESOLVED
, SQL_PLAN_OPERATION
, SQL_PLAN_OPTIONS
, EVENT
, EVENT_ID
, SEQ#
, P1TEXT
, P1
, P2TEXT
, P2
, P3TEXT
, P3
, WAIT_CLASS
, WAIT_TIME/1000000 WAIT_TIME
, SESSION_STATE
, TIME_WAITED/1000000 TIME_WAITED
, BLOCKING_SESSION_STATUS
, BLOCKING_SESSION
, BLOCKING_SESSION_SERIAL#
, BLOCKING_INST_ID
, BLOCKING_HANGCHAIN_INFO
, CURRENT_OBJ#
, CURRENT_FILE#
, CURRENT_BLOCK#
, CURRENT_ROW#
, TOP_LEVEL_CALL_NAME
, TIME_MODEL
, IN_PARSE
, IN_HARD_PARSE
from
  DBA_HIST_ACTIVE_SESS_HISTORY
where
  SESSION_ID = :SID    AND
  ( :MODULE      is null or upper(MODULE) like '%'||upper(:MODULE)||'%') AND
--module     = :MODULE AND
  sample_time  between sysdate-1440/:MINUTES and sysdate
order by
  sample_time]]></sql>
			<binds>
				<bind id="SID">
					<prompt><![CDATA[SID]]></prompt>
					<tooltip><![CDATA[SID]]></tooltip>
					<value><![CDATA[2965 ]]></value>
					<bracket><![CDATA[null]]></bracket>
				</bind>
				<bind id="MODULE">
					<prompt><![CDATA[MODULE]]></prompt>
					<tooltip><![CDATA[MODULE]]></tooltip>
					<value><![CDATA[psae]]></value>
					<bracket><![CDATA[null]]></bracket>
				</bind>
				<bind id="MINUTES">
					<prompt><![CDATA[MINUTES]]></prompt>
					<tooltip><![CDATA[MINUTES]]></tooltip>
					<value><![CDATA[30]]></value>
					<bracket><![CDATA[null]]></bracket>
				</bind>
			</binds>
		</query>
			<pdf version="VERSION_1_7" compression="CONTENT">
				<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
				<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
				<column>
					<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
					<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
					<blob blob="NONE" zip="false" />
				</column>
				<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
				<header enable="true" generatedate="true">
					<data>
					
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															</data>
					<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
				</header>
				<footer enable="true" generatedate="true">
					<data value="null" />
					<pattern pattern="#" position="6" value="1" />
				</footer>
				<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
			</pdf>
		<display id="null" type="" style="Code" enable="true">
			<name><![CDATA[SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select 
 REPLACE(ST.SQL_TEXT,chr(0)) SQL_TEXT
from 
  DBA_HIST_SQLSTAT SS
, DBA_HIST_SQLTEXT ST
where
  SS.SQL_ID          = ST.SQL_ID        AND
  SS.SQL_ID          = :SQL_ID          AND 
  SS.INSTANCE_NUMBER = :INST_ID         AND
  SS.PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
  SS.SNAP_ID         = :SNAP_ID]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="Table" enable="true">
			<name><![CDATA[Executions]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select
  SNAP_ID
, SQL_ID
, PLAN_HASH_VALUE
, EXECUTIONS_DELTA EXECUTIONS
, CASE 
    WHEN (ELAPSED_TIME_DELTA/1000000) is null then ' '
    WHEN (ELAPSED_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((ELAPSED_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((ELAPSED_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((ELAPSED_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END ELAPSED_TIME
, TO_CHAR(round((ELAPSED_TIME_DELTA/1000)/nvl(replace(EXECUTIONS_DELTA,0,1),1)),'FM999,999,990') "ELAPSED/EXEC(ms)"
, FETCHES_DELTA FETCHES
, ROWS_PROCESSED_TOTAL ROWS_PROCESSED
, SORTS_DELTA SORTS
, DISK_READS_DELTA DISK_READS
, BUFFER_GETS_DELTA BUFFER_GETS
, CASE 
    WHEN (CPU_TIME_DELTA/1000000) is null then ' '
    WHEN (CPU_TIME_DELTA/1000000) > 3600*24 then
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
    ELSE
      TO_CHAR(TRUNC((CPU_TIME_DELTA/1000000)/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD((CPU_TIME_DELTA/1000000),3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD((CPU_TIME_DELTA/1000000),60),'FM00.00')||'s'
  END CPU_TIME
--, round(CPU_TIME_DELTA/1000000,2) CPU_TIME
, round(IOWAIT_DELTA/1000000,2) IOWAIT
, round(CLWAIT_DELTA/1000000,2) CLUSTER_WAIT
, round(CCWAIT_DELTA/1000000,2) CONCURRENCY_WAIT
, round(APWAIT_DELTA/1000000,2) APPLICATION_WAIT
, DIRECT_WRITES_DELTA DIRECT_WRITES
,   CASE
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > (1024*1024) THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/(1024*1024),2),'FM000.00') || ' MB'
    WHEN IO_INTERCONNECT_BYTES_DELTA > 1024 THEN TO_CHAR(ROUND(IO_INTERCONNECT_BYTES_DELTA/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(IO_INTERCONNECT_BYTES_DELTA,'FM9000.00') || '   '
  END IO_INTERCONNECT_BYTES
from DBA_HIST_SQLSTAT
where 
  INSTANCE_NUMBER = :INST_ID AND
  SQL_ID          = :SQL_ID  AND
--PLAN_HASH_VALUE = :PLAN_HASH_VALUE AND
  SNAP_ID         = :SNAP_ID]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="Table" enable="true">
			<name><![CDATA[Explain Plan]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
SELECT 
  TIMESTAMP
, PLAN_HASH_VALUE
, LPAD('  ',2*(DEPTH-1))
  ||operation
  ||' '
  ||OPTIONS
  ||' '
  ||DECODE(id, 0, 'Cost = '
--||position
  ||
  CASE
    WHEN position >= (1000*1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000*1000),2),'FM999.00') || ' Q'
    WHEN position >= (1000*1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000*1000),2),'FM999.00') || ' T'
    WHEN position >= (1000*1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000*1000),2),'FM999.00') || ' B'
    WHEN position >= (1000*1000) THEN TO_CHAR(ROUND(position/(1000*1000),2),'FM999.00') || ' M'
    WHEN position >= 1000 THEN TO_CHAR(ROUND(position/1000,2),'FM999.00') || ' K'
    ELSE TO_CHAR(position,'FM9999') || '  '
  END
  ) "EXPLAIN PLAN"
, nvl(object_name,' ') object_name
, nvl(object_type,' ') object_type
, lpad(
  CASE
    WHEN cardinality >= 1000000000000 THEN TO_CHAR(ROUND(cardinality/1000000000000,2),'FM000.00') || ' T'
    WHEN cardinality >= 1000000000 THEN TO_CHAR(ROUND(cardinality/1000000000,2),'FM000.00') || ' B'
    WHEN cardinality >= 1000000 THEN TO_CHAR(ROUND(cardinality/1000000,2),'FM000.00') || ' M' 
    WHEN cardinality >= 1000 THEN TO_CHAR(ROUND(cardinality/1000,2),'FM000.00') || ' K'
    ELSE TO_CHAR(cardinality,'FM000') || '     '
  END , 9 , ' ' ) AS "Rows"
, CASE
    WHEN BYTES > (1024*1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024*1024),2),'FM000.00') || ' PB'
    WHEN BYTES > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN BYTES > (1024*1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN BYTES > (1024*1024) THEN TO_CHAR(ROUND(BYTES/(1024*1024),2),'FM000.00') || ' MB'
    WHEN BYTES > 1024 THEN TO_CHAR(ROUND(BYTES/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(BYTES,'FM9000.00') || '   '
  END BYTES
, CASE
    WHEN TEMP_SPACE > (1024*1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024*1024),2),'FM000.00') || ' TB'
    WHEN TEMP_SPACE > (1024*1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024*1024),2),'FM000.00') || ' GB'
    WHEN TEMP_SPACE > (1024*1024) THEN TO_CHAR(ROUND(TEMP_SPACE/(1024*1024),2),'FM000.00') || ' MB'
    WHEN TEMP_SPACE > 1024 THEN TO_CHAR(ROUND(TEMP_SPACE/1024,2),'FM000.00') || ' KB'
    ELSE TO_CHAR(TEMP_SPACE,'FM9000.00') || '   '
  END TEMP_SPACE
, CASE
    WHEN CPU_COST > 1000000000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000000000),'FM000') || ' T'
    WHEN CPU_COST > 1000000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000000),'FM000') || ' B'
    WHEN CPU_COST > 1000000 THEN TO_CHAR(TRUNC(CPU_COST/1000000),'FM000') || ' M' 
    WHEN CPU_COST > 1000 THEN TO_CHAR(TRUNC(CPU_COST/1000),'FM000') || ' K'
    ELSE TO_CHAR(CPU_COST,'FM000') || '  '
  END AS CPU_COST
, CASE
    WHEN IO_COST > 1000000000 THEN TO_CHAR(TRUNC(IO_COST/1000000000),'FM000') || ' B'
    WHEN IO_COST > 1000000 THEN TO_CHAR(TRUNC(IO_COST/1000000),'FM000') || ' M' 
    WHEN IO_COST > 1000 THEN TO_CHAR(TRUNC(IO_COST/1000),'FM000') || ' K'
    ELSE TO_CHAR(IO_COST,'FM000') || '  '
  END AS IO_COST
, CASE 
    WHEN TIME is null then ' '
    WHEN TIME > 3600*24 then
      TO_CHAR(TRUNC(TIME/3600/24),'FM990') || 'd ' ||
      TO_CHAR(TRUNC(MOD(TIME,3600*24)/3600),'FM90')|| 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
    ELSE
      TO_CHAR(TRUNC(TIME/3600),'FM90') || 'h:' ||
      TO_CHAR(TRUNC(MOD(TIME,3600)/60),'FM00') || 'm:' ||
      TO_CHAR(MOD(TIME,60),'FM00.00') ||'s'
  END TIME
, ACCESS_PREDICATES
, FILTER_PREDICATES
, PROJECTION
FROM 
  DBA_HIST_SQL_PLAN sp,
  ( SELECT
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
    , COUNT(*) entries
    FROM
      DBA_HIST_ACTIVE_SESS_HISTORY
    WHERE
      sql_id   = :SQL_ID AND
      ( sql_exec_id
      , SQL_PLAN_HASH_VALUE) IN
      ( SELECT
          sql_exec_id
        , SQL_PLAN_HASH_VALUE
        FROM
          DBA_HIST_ACTIVE_SESS_HISTORY
        WHERE
          sql_id = :SQL_ID AND
          rownum = 1
      )
    GROUP BY
      sql_id
    , sql_exec_id
    , sql_plan_line_id
    , sql_plan_hash_value
  ) ash
WHERE
  sp.sql_id               = :SQL_ID   AND
  ash.sql_id(+)           = sp.sql_id AND
  ash.sql_plan_line_id(+) = sp.id
ORDER BY
  TIMESTAMP DESC
, sp.id
/*
  sp.plan_hash_value
, sp.id
*/]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[ASH SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  BIT      date;
  EIT      date;
  dbid     number;
  start_id number;
  end_id   number;
  inst_id  number;
begin
  select distinct dbid into dbid from v$database;
  start_id := to_number(:SNAP_ID-1);
  end_id   := to_number(start_id+4);
  inst_id  := :INST_ID;
  select BEGIN_INTERVAL_TIME into BIT from DBA_HIST_SNAPSHOT where SNAP_ID = start_id and INSTANCE_NUMBER = inst_id;
  select END_INTERVAL_TIME into EIT from DBA_HIST_SNAPSHOT where SNAP_ID = end_id and INSTANCE_NUMBER = inst_id;
  dbms_output.enable(500000);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.ash_report_text( dbid,inst_id,BIT, EIT, L_SQL_ID=>:SQL_ID))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>') ;
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="Table" enable="true">
			<name><![CDATA[AWR SQL]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
select output from table(dbms_workload_repository.AWR_SQL_REPORT_TEXT( (select dbid from v$database),
                                                            :INST_ID,
                                                            :SNAP_ID-3, :SNAP_ID+1,
                                                            :SQL_ID ))]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[AWR]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date  : 2015/08/27 (of last update/validation)
declare
  dbid     number;
  start_id number;
  end_id   number;
begin
  dbms_output.enable(1000000);
  select distinct dbid into dbid from gv$database;
  start_id := to_number(:SNAP_ID-3);
  end_id   := to_number(start_id+4);
  dbms_output.put_line('<PRE>');
  for rc in ( select output from 
    table(dbms_workload_repository.awr_report_text(dbid,:INST_ID,start_id,end_id))) loop
    dbms_output.put_line(rc.output);
  end loop;
  dbms_output.put_line('</PRE>');
end;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="plsql-dbms_output" enable="true">
			<name><![CDATA[Tuning Advice]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
			</CustomValues>
			<query>
				<sql><![CDATA[--- Author: Anand Mahajani
--- Date: 2018/04/11 (of last update/validation)
declare
  l_sql              VARCHAR2(500) := :SQL_ID;
  l_sql_tune_task_id VARCHAR2(400);
  l_task_name        VARCHAR2(400) := 'tuning_task_'||l_sql;
  l_descr            VARCHAR2(400) := 'Tuning task for statement '||l_sql;
  recommendations    VARCHAR2(2000);
  RetVal             CLOB;
  MAXBUFSIZE         NUMBER := 32767;
BEGIN
  dbms_output.enable(1000000);
  l_sql_tune_task_id := dbms_sqltune.create_tuning_task ( sql_id => l_sql, time_limit => 1200, task_name => l_task_name, description => l_descr);
  begin
    DBMS_SQLTUNE.reset_tuning_task (task_name => l_task_name);
    DBMS_SQLTUNE.execute_tuning_task(task_name => l_task_name);
    RetVal := dbms_sqltune.report_tuning_task(l_sql_tune_task_id);
    dbms_output.put_line('<PRE>');
    dbms_output.put_line(dbms_lob.substr( RetVal, MAXBUFSIZE-1, 1 ));
    dbms_output.put_line('</PRE>');
    dbms_sqltune.DROP_TUNING_TASK(l_task_name);
  exception 
    when others then
      dbms_output.put_line('Unable to produce report.');
      dbms_output.put_line(SQLERRM);
      dbms_sqltune.DROP_TUNING_TASK(l_task_name);
  end; 
END;]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="Table" enable="true">
			<name><![CDATA[XPlan Cursor]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select * from table(dbms_xplan.display_cursor(:SQL_ID, :CHILD#, FORMAT=>'ALL'))
--select * from table(dbms_xplan.display_cursor(:SQL_ID ,FORMAT=>'ALL'))]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
		<display id="null" type="" style="Table" enable="true">
			<name><![CDATA[XPlan AWR]]></name>
			<description><![CDATA[]]></description>
			<tooltip><![CDATA[]]></tooltip>
			<drillclass><![CDATA[]]></drillclass>
			<CustomValues>
				<TYPE><![CDATA[horizontal]]></TYPE>
			</CustomValues>
			<query>
				<sql><![CDATA[select * from table(dbms_xplan.display_awr(:SQL_ID,FORMAT=>'ALL'))]]></sql>
			</query>
				<pdf version="VERSION_1_7" compression="CONTENT">
					<docproperty title="" author="Anand Mahajani" subject="" keywords="" />
					<cell toppadding="1" bottompadding="1" leftpadding="1" rightpadding="1" horizontalalign="LEFT" verticalalign="TOP" wrap="true" />
					<column>
						<heading font="Times New Roman" size="10" style="BOLD" color="-16777216" rowshading="-1579033" labeling="ALL_PAGES" />
						<footing font="Times New Roman" size="10" style="NORMAL" color="-16777216" rowshading="-1" labeling="NONE" />
						<blob blob="NONE" zip="false" />
					</column>
					<table font="Times New Roman" size="10" style="NORMAL" color="-16777216" userowshading="false" oddrowshading="-1" evenrowshading="-1" showborders="true" spacingbefore="10" spacingafter="10" horizontalalign="LEFT" />
					<header enable="true" generatedate="true">
						<data>
						
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							
							{\rtf1\ansi
{\fonttbl\f0\fnil Monospaced;\f1\fnil Times New Roman;}

\li0\ri0\fi0\f1\fs20\i0\b0\ul0\cf0 Date: 3/9/2018 3:00:41 PM\fs24\ul0
}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	</data>
						<pattern pattern="M/d/yyyy h:mm:ss a" position="6" value="3/9/2018 3:00:41 PM" />
					</header>
					<footer enable="true" generatedate="true">
						<data value="null" />
						<pattern pattern="#" position="6" value="1" />
					</footer>
					<pagesetup papersize="LETTER" orientation="1" measurement="in" margintop="1.0" marginbottom="1.0" marginleft="1.0" marginright="1.0" />
				</pdf>
		</display>
	</display>
</folder>
</displays>